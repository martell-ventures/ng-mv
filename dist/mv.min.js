!function(){var a=angular.module("mv.billing",["mv.configuration","mv.widgets"]);a.factory("creditCards",[function(){function a(a){for(var b=!0,c=0,d=(a+"").split("").reverse(),e=0;e<d.length;e++){var f=parseInt(d[e],10);(b=!b)&&(f*=2),f>9&&(f-=9),c+=f}return c%10===0}var b=/(\d{1,4})/g,c=[{type:"discover",pattern:/^(6011|65|64[4-9]|622)/,format:b,length:[16],cvcLength:[3],luhn:!0},{type:"mastercard",format:b,pattern:/^5[1-5]/,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[4],luhn:!0},{type:"visa",pattern:/^4/,format:b,length:[13,14,15,16],cvcLength:[3],luhn:!0}];return{fromNumber:function(a){var b;for(a=(a+"").replace(/\D/g,""),b=0;b<c.length;b++){var d=c[b];if(d.pattern.test(a))return d}return null},fromType:function(a){var b;for(b=0;b<c.length;b++){var d=c[b];if(d.type===a)return d}},numberValidForCard:function(b,c){var d=(c+"").replace(/\D/g,""),e=!1;return b.length.indexOf(d.length)>=0&&(e=b.luhn?a(d):!0),e},formatCardNumber:function(a,b){var c,d,e;if(!a)return b;if(d=a.length[a.length.length-1],b=b.replace(/\D/g,""),b=b.slice(0,+d+1||9e9),a.format.global)return null!=(e=b.match(a.format))?e.join(" "):void 0;if(c=a.format.exec(b),null!=c){c.shift();var f=[];angular.forEach(c,function(a){a&&f.push(a)}),c=f}return null!=c?c.join(" "):void 0},cvcValidForCard:function(a,b){var c=(b+"").replace(/\D/g,""),d=!1;return a.cvcLength.indexOf(c.length)>=0&&(d=!0),d}}}]),a.directive("creditCardCvv",["creditCards",function(a){return{restrict:"A",require:"?ngModel",scope:{cardNumber:"=creditCardCvv"},link:function(b,c,d,e){function f(a){if(a){var b=a.replace(/[^0-9]/g,"");return b!==a&&(e.$setViewValue(b),e.$render()),b}return void 0}e&&(e.$validators.validSecurityCode=function(d,e){var f=!1,g=a.fromNumber(b.cardNumber);return f=g&&a.cvcValidForCard(g,e)?!0:!1,c.prop("required")||(f=!0),f},e.$parsers.unshift(f),b.$watch(function(){return c.prop("required")},function(a){e.$validate()}),b.$watch("cardNumber",function(){var d=a.fromNumber(b.cardNumber);d?c.attr("maxLength",2==d.cvcLength.length?d.cvcLength[1]:d.cvcLength[0]):c.attr("maxLength",4),e.$validate()}))}}}]),a.directive("creditCardNumber",["creditCards",function(a){return{restrict:"A",require:"?ngModel",scope:{cardType:"=?"},link:function(b,c,d,e){function f(b){if(b){var c,d=a.fromNumber(b);return c=d?a.formatCardNumber(d,b):b.replace(/[^0-9 ]/g,""),c!==b&&(e.$setViewValue(c),e.$render()),c}return void 0}e&&(e.$validators.validCardNumber=function(d,e){var f=d||e,g=!1,h=a.fromNumber(f);if(h){b.cardType=h.type;var i=f.replace(/ /g,""),j=f.length-i.length;c.attr("minLength",h.length[0]+j),c.attr("maxLength",h.length[h.length.length-1]+j),a.numberValidForCard(h,f)&&(g=!0)}else b.cardType=void 0,c.attr("minLength",13),c.attr("maxLength",16);return c.prop("required")||(g=!0),g},e.$parsers.unshift(f),b.$watch(function(){return c.prop("required")},function(a){e.$validate()}))}}}]),a.directive("creditCardExpirationMonth",function(){return{restrict:"A",require:"?ngModel",scope:{expirationYear:"="},link:function(a,b,c,d){if(d){if("SELECT"==b.prop("tagName"))for(var e=["January","February","March","April","May","June","July","August","September","October","November","December"],f=0;f<e.length;f++){var g=f+1,h=angular.element('<option value="'+g+'">'+g+" - "+e[f]+"</option>");b.append(h)}d.$validators.validExpirationMonth=function(c,d){var e=c||d,f=!0;if(a.expirationYear){var g=parseInt(a.expirationYear),h=new Date,i=parseInt(e)-1;g==h.getFullYear()&&i<=h.getMonth()&&(f=!1)}return b.prop("required")||(f=!0),f},a.$watch("expirationYear",function(){d.$validate()}),a.$watch(function(){return b.prop("required")},function(a){d.$validate()})}}}}),a.directive("creditCardExpirationYear",function(){return{restrict:"A",require:"?ngModel",link:function(a,b,c,d){if(d){if("SELECT"==b.prop("tagName"))for(var e=new Date,f=0;10>f;f++){var g=e.getFullYear()+f,h=angular.element('<option value="'+g+'">'+g+"</option>");b.append(h)}d.$validators.validExpirationYear=function(a,c){var d=a||c,e=new Date,f=parseInt(d),g=f<e.getFullYear()?!1:!0;return b.prop("required")||(g=!0),g},a.$watch(function(){return b.prop("required")},function(a){d.$validate()})}}}}),a.directive("creditCardExpirationEntry",function(){return{restrict:"A",require:"?ngModel",scope:{year:"=",month:"=",yearDigits:"@?"},link:function(a,b,c,d){function e(a){if(a){var b=a.replace(/[^0-9]/g,"");return 1==b.length&&"0"!=b.substr(0,1)&&"1"!=b.substr(0,1)&&(b=""),2==b.length?"1"==b.substr(0,1)&&parseInt(b.substr(1,1),10)>2?b=b.substr(0,1):a.length>=3&&"/"==a.substr(2,1)&&(b=a.substr(0,3)):b.length>2&&(b=b.substr(0,2)+"/"+b.substr(2),b=b.substr(0,3+h)),b!==a&&(d.$setViewValue(b),d.$render()),b}return void 0}function f(a){var b;if(a){var c=a.replace(/[^0-9]/g,"");c.length>=2&&(b=parseInt(c.substr(0,2),10))}return b}function g(a){var b;if(a){var c=a.replace(/[^0-9]/g,"");c.length==2+h&&(b=2==h?2e3+parseInt(c.substr(2,h),10):parseInt(c.substr(2,h),10))}return b}var h=c.yearDigits?parseInt(c.yearDigits):2;d&&(d.$validators.validExpirationDate=function(a,c){var d=a||c,e=g(d),h=f(d),i=!1;if(void 0!==e&&void 0!==h){var j=new Date;e>j.getFullYear()?i=!0:e==j.getFullYear()&&h>j.getMonth()+1&&(i=!0)}return b.prop("required")||(i=!0),i},d.$parsers.unshift(e),a.$watch(function(){return d.$modelValue},function(b){b?(a.month=""+f(b),a.year=""+g(b)):(a.month=void 0,a.year=void 0)}))}}}),a.directive("creditCardInformation",["$mvConfiguration","creditCards",function(a,b){return{restrict:"E",templateUrl:function(b,c){var d="";return d=void 0!==c.templateUrl?c.templateUrl:void 0!==c.typeExpiration?a.templateBasePath+"credit-card-information-type-expiration.html":a.templateBasePath+"credit-card-information.html"},scope:{cardholderName:"=",cardNumber:"=",cardType:"=?",expirationMonth:"=",expirationYear:"=",securityCode:"=",saveCard:"=?",cardRequired:"=?"},link:function(a,b,c){a.state={months:[],allowCardSave:void 0===a.saveCard?!1:!0,required:!0},a.$watch("cardRequired",function(b){a.state.required=void 0===b?!0:b})}}}])}(),function(){var a=angular.module("mv.configuration",[]);a.provider("$mvConfiguration",function(){var a={options:{templateBasePath:"defaultTemplatePath"},setTemplateBasePath:function(a){this.options.templateBasePath=a},$get:["$injector",function(a){var b={templateBasePath:this.options.templateBasePath};return b}]};return a})}(),function(){var a=angular.module("mv.facebook",[]);a.provider("$mvFacebookConfiguration",function(){function a(a,b){void 0===b&&(b="en_US"),void 0===a&&(a=!1);var c="//connect.facebook.net/"+b+"/";return c+=a?"all/debug.js":"all.js"}var b={options:{applicationID:"",redirectURL:"",language:"en_US",debug:!1,facebookScriptURL:"//connect.facebook.net/en_US/all.js",scope:"email"},setLoginRequiredScope:function(a){this.options.scope=a},setDebugMode:function(a){this.options.debug=a},setApplicationID:function(a){this.options.applicationID=a},setRedirectURL:function(a){this.options.redirectURL=a},setLanguage:function(a){this.options.language=a},$get:["$injector",function(b){var c={applicationID:this.options.applicationID,redirectURL:this.options.redirectURL,facebookScriptURL:a(this.options.debug,this.options.language),scriptDOMElementID:"facebook-sdk-script",scope:this.options.scope};return c}]};return b}),a.service("loadFacebookJavascript",["$window","$q","$mvFacebookConfiguration",function(a,b,c){function d(){if(!document.getElementById(c.scriptDOMElementID)){var a=document.createElement("script");a.id=c.scriptDOMElementID,a.src=c.facebookScriptURL,document.body.appendChild(a)}}var e=b.defer();if(a.fbAsyncInit=function(){FB.init({appId:c.applicationID,status:!0,cookie:!0,xfbml:!0,redirect_url:c.redirectURL}),e.resolve()},!c.applicationID||0===c.applicationID.length)throw alert("You must configure the facebook application id!"),new Error("You must configure the facebook application id!");if(!c.redirectURL||0===c.redirectURL.length)throw alert("You must configure the facebook redirect URL!"),new Error("You must configure the facebook redirect URL!");return d(),e.promise}]),a.directive("facebookLoginButton",["loadFacebookJavascript","$timeout","$parse","$mvFacebookConfiguration",function(a,b,c,d){return{restrict:"A",link:function(e,f,g){if(!g.facebookLoginButton)throw new Error("You must supply a facebook callback");var h=c(g.facebookLoginButton);a.then(function(){f.on("click",function(){FB.login(function(a){a.authResponse?FB.api("/me",function(a){b(function(){h(e,{status:"success",response:a})},50)}):b(function(){h(e,{status:"cancelled",response:a})},50)},{scope:d.scope,auth_type:"rerequest"})})},function(){h(e,{status:"loadingError",response:{}})})}}}]),a.directive("facebookPostButton",["loadFacebookJavascript","$timeout","$parse",function(a,b,c){return{restrict:"A",link:function(d,e,f){function g(){FB.ui({method:"feed",link:f.shareLink,picture:f.shareImage,name:f.shareName,description:f.shareDescription},function(a){b(function(){a?i(d,{status:"success",response:a}):i(d,{status:"cancelled",response:a})},50)})}function h(){j&&FB.api("/me",function(a){b(function(){j(d,{status:"success",response:a})},50)})}if(!f.facebookPostButton)throw new Error("You must supply a facebook callback");var i=c(f.facebookPostButton),j=null;f.loginCallback&&(j=c(f.loginCallback)),a.then(function(){e.on("click",function(){FB.getLoginStatus(function(a){"connected"==a.status?g():FB.login(function(a){a.authResponse?(g(),h()):b(function(){i(d,{status:"cancelled",response:a})},50)},{scope:"email"})})})},function(){i(d,{status:"loadingError",response:{}})})}}}])}(),function(){var a=angular.module("mv.filters",[]);a.filter("capitalize",function(){return function(a,b){return null!=a&&(a=a.toLowerCase()),a.substring(0,1).toUpperCase()+a.substring(1)}}),a.filter("max",function(){return function(a,b){a=a||"";var c=parseInt(a);return c>b&&(c=b),""+c}})}(),function(){var a=angular.module("mv.forms",["mv.configuration","mv.widgets"]);a.directive("postalCode",function(){return{require:"?ngModel",restrict:"A",scope:{countryCode:"=postalCode"},link:function(a,b,c,d){function e(b){if("US"==a.countryCode){if(b){var c=b.replace(/[^0-9 \-]/g,"");return c!==b&&(d.$setViewValue(c),d.$render()),c}return void 0}return b}function f(c,d){var e=c||d,f=!1;if("US"==a.countryCode){var g=e?e.replace(/[^0-9]/g,""):"";f=9==g.length||5==g.length?!0:!1}else f=!0;return b.prop("required")||(f=!0),f}d&&(d.$validators.validUSZip=f,d.$parsers.unshift(e),a.$watch("countryCode",function(a,c){"US"==a?b.prop("placeholder")&&b.prop("placeholder","Zip"):void 0!==a&&b.prop("placeholder")&&b.prop("placeholder","Postal Code"),d.$validate()}),a.$watch(function(){return b.prop("required")},function(a){d.$validate()}))}}}),a.directive("mvAddress",["$http","$mvConfiguration","$parse",function(a,b,c){return{restrict:"E",templateUrl:function(a,c){var d="";return d=void 0!==c.templateUrl?c.templateUrl:b.templateBasePath+"address-elements.html"},scope:{street:"=",street2:"=?",city:"=",state:"=",zip:"=",country:"=",requiredFields:"=",useStreet2:"=?",fieldChanged:"&?",filterCountries:"&?"},link:function(c,d,e){function f(a,b){var c=null;if(void 0!==a){var d=a.trim().toLowerCase();angular.forEach(b,function(a){(d==a.Abbreviation.toLowerCase()||d==a.Name.toLowerCase())&&(c=a)})}return c}function g(){a.get(b.templateBasePath+"countries.json").success(function(a){if(e.filterCountries){var b=[];angular.forEach(a,function(a){c.filterCountries({country:a})&&b.push(a)}),c.countries=b}else c.countries=a;var d=!1,g=!1;angular.forEach(c.countries,function(a){"US"==a.Code&&(g=!0),c.country==a.Code&&(d=!0)}),d||(c.country=e.defaultCountryCode?e.defaultCountryCode:g?"US":c.countries[0].Code),angular.forEach(c.countries,function(a){if(a.Code==c.country&&(c.countryObject=a,a.States)){var b=f(c.state,a.States);b&&(c.state=b.Abbreviation)}})})}var h={};c.countries=[],c.disabled=!1,void 0!==e.ngDisabled&&c.$parent.$watch(e.ngDisabled,function(a){c.disabled=a}),c.street||(c.street=""),c.useStreet2&&!c.street2&&(c.street2=""),c.city||(c.city=""),c.state||(c.state=""),c.zip||(c.zip=""),c.state&&c.country&&(h[c.country]=c.state),c.$watch("countryObject",function(a){a&&a.Code!=c.country&&(c.country=a.Code,c.state=h[c.country]?h[c.country]:"")}),c.sendChange=function(a,b,d){c.fieldChanged&&c.fieldChanged({field:e[a],newValue:b,oldValue:d})},c.$watch("country",function(a){if(c.countryObject&&a!=c.countryObject.Code){var b=!1;angular.forEach(c.countries,function(d){d.Code==a&&(window.console.log("Change the country object!"),c.countryObject=d,b=!0)}),b||window.console.log("Change the country object; country "+a+" NOT FOUND!")}}),c.$watch("state",function(a,b){a!==b&&(h[c.country]=a)}),c.stateRequired=function(){var a;return a="US"==c.country||"CA"==c.country?c.requiredFields&&c.requiredFields.state:!1},g(),c.$on("mv-reload-countries",function(){g()})}}}])}(),function(){var a=angular.module("mv.upload.button",[]);a.directive("mvInlineUploadButton",["$q","$http","$parse",function(a,b,c){return{restrict:"A",scope:!0,link:function(d,e,f){function g(){var a=e.find("input[type=file]");a.wrap("<form>").closest("form").get(0).reset(),a.unwrap()}function h(){return a(function(a,c){b.post(f.endpointUrl,{verb:"upload-complete",id:f.identifier,bucket:k.uploadBucket,key:k.uploadKey,type:f.type,mimeType:k.mimeType}).then(function(b){b.data.success?a(b.data):(alert(b.data.message),c())},c)})}function i(a,c){b.post(f.endpointUrl,{verb:"upload-parameters",filename:a,id:f.identifier,type:f.type,mimeType:c}).then(function(a){a.data.success?(k={postURL:a.data.result.url,uploadBucket:a.data.result.bucket,uploadParameters:a.data.result.params,uploadKey:a.data.result.params.key,mimeType:a.data.result.mimeType},j().then(function(a){h().then(function(a){m&&m(d,a.result),g()},function(a){g()})},function(a){switch(a.reason){case"loadFailed":alert("There was an error attempting to upload the file."+a.evt.response);break;case"error":alert("There was an error attempting to upload the file."+a.evt.response);break;case"aborted":alert("The upload has been canceled by the user or the browser dropped the connection.")}g()})):(alert(a.data.message),g())})}function j(){return a(function(a,b){var c=new FormData;for(var f in k.uploadParameters)c.append(f,k.uploadParameters[f]);c.append("success_action_status",201);var g=e.find("input[type=file]").get(0).files[0];c.append("file",g);var h=new XMLHttpRequest;h.upload.addEventListener("progress",function(a){if(a.lengthComputable){var b=Math.round(100*a.loaded/a.total);n&&b!=n(d)&&d.$apply(function(){n.assign(d,b)})}},!1),h.addEventListener("load",function(c){d.$apply(c&&201==c.currentTarget.status?function(){o&&o.assign(d,!1),a()}:function(){o&&o.assign(d,!1),b({reason:"loadFailed",evt:c.currentTarget})})},!1),h.addEventListener("error",function(a){d.$apply(function(){o&&o.assign(d,!1),b({reason:"error",evt:a})})},!1),h.addEventListener("abort",function(a){d.$apply(function(){o&&o.assign(d,!1),b({reason:"aborted"})})},!1),o&&o.assign(d,!0),n&&n.assign(d,0),h.open("POST",k.postURL,!0),h.send(c)})}e.addClass("upload_button"),e.append('<input type="file" accept="'+f.accept+'">');var k=null,l=null,m=null,n=null,o=null;f.previewImageSrc&&(l=c(f.previewImageSrc)),f.onCompletion&&(m=c(f.onCompletion)),f.uploadProgress&&(n=c(f.uploadProgress)),f.uploading&&(o=c(f.uploading)),e.find("input[type=file]").on("change",function(){if($(this).val()){var a=this.files?this.files:[];if(a.length){{var b=$(this).val();f.identifier}if(b){var c=a[0].name,e=a[0].type,h=f.accept.split("/"),j=e.split("/"),k=!0;if(h.length==j.length)for(var m=0;m<h.length;m++)h[m]!=j[m]&&"*"!=h[m]&&(k=!1);if(k)if(window.FileReader)if(/^image/.test(e)){var n=f.minImageWidth||0,o=f.minImageHeight||0,p=new FileReader;p.onloadend=function(){var a=this.result;if(n||o){var b=new Image;b.onload=function(){if(n&&this.width<n||o&&this.height<o){var a=[];a.push("This image is too small."),n&&a.push("It must be at least "+n+" pixels wide (It is currently "+this.width+")"),o&&a.push("It must be at least "+o+" pixels tall (It is currently "+this.height+")"),alert(a.join("\n")),g()}else d.$apply(function(){i(c,e)})},b.src=a}d.$apply(function(){l.assign(d,a),n||o||i(c,e)})},p.readAsDataURL(a[0])}else f.defaultPreviewImage?(l.assign(d,f.defaultPreviewImage),i(c,e)):i(c,e);else i(c,e);else{var q="Invalid file type!";if(h.length)switch(h[0]){case"video":q="The selected file is not a valid video file.";break;case"image":q="The selected file is not a valid image file.";break;case"audio":q="The selected file is not a valid audio file."}alert(q),g()}}}}})}}}]),a.directive("mvUploadButtonWithProgress",["$q","$http",function(a,b){return{restrict:"E",scope:{title:"@",accept:"@",type:"@",identifier:"@",endpointUrl:"@",previewImageSrc:"=?",onCompletion:"&?",minImageWidth:"@?",minImageHeight:"@?"},template:'<div><progressbar ng-show="state.uploading" style="width: 100%;" value="state.progress"></progressbar><span ng-show="!state.uploading" class="btn btn-file btn-default btn-sm" mv-inline-upload-button type="{{ type }}" accept="{{ accept }}" identifier="{{ identifier }}" endpoint-url="{{ endpointUrl }}" preview-image-src="state.previewImageSrc" on-completion="complete(bucket, key, url)" upload-progress="state.progress" uploading="state.uploading" min-image-width="{{ minImageWidth }}" min-image-height="{{ minImageHeight }}" >{{ title }}</span></div>',link:function(a,b,c){a.state={uploading:!1,progress:0,previewImageSrc:null},a.$watch("state.previewImageSrc",function(b){a.previewImageSrc&&(a.previewImageSrc=b)}),a.complete=function(b,c,d){a.onCompletion&&a.onCompletion({bucket:b,key:c,url:d})}}}}])}(),function(){var a=angular.module("mv.utils",["mv.filters","mv.configuration","ui.bootstrap"]);a.directive("compareTo",function(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(a,b,c,d){d.$validators.compareTo=function(b){return b==a.otherModelValue},a.$watch("otherModelValue",function(){d.$validate()})}}}),a.service("Dialogs",["$modal","$sce","$mvConfiguration",function(a,b,c){this.Confirm=function(d,e,f){return a.open({controller:["$scope","$modalInstance","message","title","buttons",function(a,c,d,e,f){a.message=b.trustAsHtml(d),a.title=e,a.buttons=f,a.clickButton=function(a){"cancel"==a.type?c.dismiss(a.name):c.close(a)}}],templateUrl:c.templateBasePath+"dialogs/confirm-modal.html",resolve:{message:function(){return d},buttons:function(){return void 0===f?[{name:"OK",type:"ok"},{name:"Cancel",type:"cancel"}]:f},title:function(){return void 0===e?"Confirm":e}}}).result},this.SingleTextAreaEntry=function(d,e,f){return a.open({controller:["$scope","$modalInstance","$mvConfiguration","message","title","buttons",function(a,c,d,e,f,g){a.message=b.trustAsHtml(e),a.title=f,a.buttons=g,a.params={textAreaEntry:""},a.clickButton=function(b){"cancel"==b.type?c.dismiss(b.name):c.close({button:b,textAreaEntry:a.params.textAreaEntry})}}],templateUrl:c.templateBasePath+"dialogs/single-text-area-modal.html",resolve:{message:function(){return d},buttons:function(){return void 0===f?[{name:"OK",type:"ok"},{name:"Cancel",type:"cancel"}]:f},title:function(){return void 0===e?"Confirm":e}}}).result}}]),a.service("UtilService",function(){this.CalculateTimeDeltas=function(a,b){var c=new Date,d=null,e=null;b&&(b instanceof Date?d=b:"0000-00-00"!=b&&(d=Date.parse(b))),e=a?a instanceof Date?a:Date.parse(a):c;var f={days:0,hours:0,minutes:0,seconds:0,timeUnits:"",timeValue:""};if(null!=d){var g=c>e?c:e;if(d>g){var h=Math.abs(d-g)/1e3,i=Math.floor(h/86400);h-=86400*i;var j=Math.floor(h/3600)%24;h-=3600*j;var k=Math.floor(h/60)%60;h-=60*k;var l=h%60;f.days=i,f.hours=j,f.minutes=k,f.seconds=l,i>0?(f.timeValue=i,f.timeUnits=1==i?"day left":"days left"):j>0?(f.timeValue=j,f.timeUnits=1==j?"hour left":"hours left"):k>0?(f.timeValue=k,f.timeUnits=1==k?"minute left":"minutes left"):l>0&&(f.timeValue=l,f.timeUnits=1==l?"second left":"seconds left")}else f.timeValue=""}else f.timeValue="Unknown",f.timeUnits="days left";return f}}),a.directive("onlyDigits",function(){return{restrict:"EA",require:"?ngModel",link:function(a,b,c,d){d&&d.$parsers.unshift(function(a){var b=!1,e=a.split("").filter(function(a,d){var e=!isNaN(a)&&" "!=a;return!e&&c.allowDecimal&&"true"==c.allowDecimal&&"."==a&&b===!1&&(b=!0,e=!0),!e&&c.allowNegative&&"true"==c.allowNegative&&(e="-"==a&&0===parseInt(d)),e}).join("");return c.maxNum&&!isNaN(c.maxNum)&&parseFloat(e)>parseFloat(c.maxNum)&&(e=c.maxNum),c.minNum&&!isNaN(c.minNum)&&parseFloat(e)<parseFloat(c.minNum)&&(e=c.minNum),d.$setViewValue(e),d.$render(),e})}}}),a.directive("onlyNumber",function(){return{require:"ngModel",restrict:"AC",link:function(a,b,c,d){function e(a){if(a){var b=a.replace(/[^0-9]/g,"");return b!==a&&(d.$setViewValue(b),d.$render()),parseInt(b,10)}return void 0}d.$parsers.push(e)}}}),a.directive("thousandsComma",["$filter",function(a){return{require:"?ngModel",link:function(b,c,d,e){function f(b){var d,e;return""!==b?(e=b.replace(/[\,\.]/g,""),d=a("number")(e),c.val(d)):(d="",e=""),c.val(d),e}function g(a){if(a){var b=a.replace(/[^0-9\,]/g,"");return b!==a&&(e.$setViewValue(b),e.$render()),b}return void 0}e&&(e.$formatters.unshift(function(){return""!==e.$modelValue?a("number")(e.$modelValue):""}),e.$parsers.unshift(f),e.$parsers.unshift(g))}}}]),a.directive("mvEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.mvEnter)}),b.preventDefault())})}}),/**
		 * angular-elastic-input
		 * A directive for AngularJS which automatically resizes the width of input field according to the content, while typing.
		 * @author: Jacek Pulit <jacek.pulit@gmail.com>
		 * @license: MIT License
		 */
a.directive("mvElasticInput",function(){return{require:"?ngModel",restrict:"A",link:function(a,b,c,d){function e(){g.text(c.placeholder?b.val()||c.placeholder:b.val()),b.css("width",g.outerWidth()+1)}var f=angular.element('<div style="position:fixed; top:-999px; left:0;"></div>'),g=angular.element('<span style="white-space:pre;"></span>'),h="none"===b.css("maxWidth")?b.parent().innerWidth():b.css("maxWidth");b.css("minWidth",c.mvElasticInputMinwidth||b.css("minWidth")),b.css("maxWidth",c.mvElasticInputMaxwidth||h),angular.forEach(["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent","boxSizing","borderRightWidth","borderLeftWidth","borderLeftStyle","borderRightStyle","paddingLeft","paddingRight","marginLeft","marginRight"],function(a){g.css(a,b.css(a))}),angular.element("body").append(f.append(g)),e(),d?a.$watch(c.ngModel,function(){e()}):b.on("keydown keyup focus input propertychange change",function(){e()})}}})}(),function(){var a=angular.module("mv.widgets",[]);a.directive("showValidationIcon",function(){return{restrict:"A",require:"?ngModel",link:function(a,b,c,d){function e(a,b){a?b?(f.removeClass("has-error").addClass("has-success"),void 0!==g&&g.removeClass("hidden").removeClass("glyphicon-remove").addClass("glyphicon-ok")):(f.removeClass("has-success").addClass("has-error"),void 0!==g&&g.removeClass("hidden").removeClass("glyphicon-ok").addClass("glyphicon-remove")):(f.removeClass("has-success").removeClass("has-error"),void 0!==g&&g.addClass("hidden"))}if(d){var f=b.parents(".form-group:first");f&&f.addClass("has-feedback");var g;"INPUT"!=b.prop("tagName")||b.parent().hasClass("input-group")||(g=angular.element('<span class=" form-control-feedback glyphicon glyphicon-ok hidden"></span>'),b.after(g)),a.$watch(function(){return d.$dirty+"-"+d.$valid+"-"+d.$touched},function(){var a=d.$dirty||d.$touched;e(a,d.$valid)})}}}}),a.directive("flashAlert",["$timeout",function(a){return{restrict:"E",scope:{type:"=",message:"=",duration:"=?"},template:'<div ng-show="message" class="alert" ng-class="alertClass"><button type="button" class="close" ng-click="visible= false">x</button><strong>{{ strongText }}</strong> <span ng-bind-html="message"></span></div>',link:function(b,c,d){b.$watch("type",function(){if(b.type)switch(b.type){case"info":b.alertClass="alert-info",b.strongText="";break;case"warning":b.alertClass="alert-warning",b.strongText="Warning:";break;case"error":b.alertClass="alert-danger",b.strongText="Error:";break;case"success":b.alertClass="alert-success",b.strongText=""}}),b.$watch("message",function(c){if(c){var d=b.duration||5e3;a(function(){b.message=void 0},d)}})}}}]),a.directive("itemExpander",function(){return{restrict:"E",transclude:!0,scope:{title:"@",expanded:"=?"},template:'<h4><a href="#" ng-click="toggle($event)"><span class="glyphicon" ng-class="iconClass"></span>{{ title }}</a></h4><div ng-show="expanded"><ng-transclude></ng-transclude></div>',link:function(a,b,c){a.toggle=function(b){b.preventDefault(),a.expanded=!a.expanded},a.$watch("expanded",function(b){a.iconClass=b?"glyphicon-collapse-down":"glyphicon-collapse-up"})}}}),a.directive("audioPlayer",function(){return{restrict:"E",link:function(a,b,c){c.audioUrl?(b.append('<div id="'+c.containerId+'">Loading the player...</div>'),jwplayer(c.containerId).setup({file:c.audioUrl,supplied:"mp3",width:"100%",height:30})):b.append('<p class="text-center h4">This audio is still processing on the server.<br/>Please refresh this page in a few minutes.</p>')}}}),a.directive("videoPlayer",function(){return{restrict:"E",link:function(a,b,c){c.videoUrl?(b.append('<div id="'+c.containerId+'">Loading the player...</div>'),jwplayer(c.containerId).setup({file:c.videoUrl,image:c.imageUrl,width:"100%",aspectratio:c.width+":"+c.height,stretching:"exactfit"})):b.append('<p class="text-center h4">This video is still processing on the server.<br/>Please refresh this page in a few minutes to view.</p>')}}})}();