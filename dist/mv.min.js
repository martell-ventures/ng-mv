!function(){var a=angular.module("mv.billing",["mv.configuration","mv.widgets"]);a.factory("creditCards",[function(){function a(a){for(var b=!0,c=0,d=(a+"").split("").reverse(),e=0;e<d.length;e++){var f=parseInt(d[e],10);(b=!b)&&(f*=2),f>9&&(f-=9),c+=f}return c%10===0}var b=/(\d{1,4})/g,c=[{type:"discover",pattern:/^(6011|65|64[4-9]|622)/,format:b,length:[16],cvcLength:[3],luhn:!0},{type:"mastercard",format:b,pattern:/^5[1-5]/,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[4],luhn:!0},{type:"visa",pattern:/^4/,format:b,length:[13,14,15,16],cvcLength:[3],luhn:!0}];return{fromNumber:function(a){var b;for(a=(a+"").replace(/\D/g,""),b=0;b<c.length;b++){var d=c[b];if(d.pattern.test(a))return d}return null},fromType:function(a){var b;for(b=0;b<c.length;b++){var d=c[b];if(d.type===a)return d}},numberValidForCard:function(b,c){var d=(c+"").replace(/\D/g,""),e=!1;return b.length.indexOf(d.length)>=0&&(e=b.luhn?a(d):!0),e},formatCardNumber:function(a,b){var c,d,e;if(!a)return b;if(d=a.length[a.length.length-1],b=b.replace(/\D/g,""),b=b.slice(0,+d+1||9e9),a.format.global)return null!=(e=b.match(a.format))?e.join(" "):void 0;if(c=a.format.exec(b),null!=c){c.shift();var f=[];angular.forEach(c,function(a){a&&f.push(a)}),c=f}return null!=c?c.join(" "):void 0},cvcValidForCard:function(a,b){var c=(b+"").replace(/\D/g,""),d=!1;return a.cvcLength.indexOf(c.length)>=0&&(d=!0),d}}}]),a.directive("creditCardCvv",["creditCards",function(a){return{restrict:"A",require:"?ngModel",scope:{cardNumber:"=creditCardCvv"},link:function(b,c,d,e){function f(a){if(a){var b=a.replace(/[^0-9]/g,"");return b!==a&&(e.$setViewValue(b),e.$render()),b}return void 0}e&&((void 0===c.prop("id")||""===c.prop("id"))&&c.prop("id","cardCsc"),e.$validators.validSecurityCode=function(d,e){var f=!1,g=a.fromNumber(b.cardNumber);return f=g&&a.cvcValidForCard(g,e)?!0:!1,c.prop("required")||(f=!0),f},e.$parsers.unshift(f),b.$watch(function(){return c.prop("required")},function(a){e.$validate()}),b.$watch("cardNumber",function(){var d=a.fromNumber(b.cardNumber);d?c.attr("maxLength",2==d.cvcLength.length?d.cvcLength[1]:d.cvcLength[0]):c.attr("maxLength",4),e.$validate()}))}}}]),a.directive("creditCardNumber",["creditCards","$timeout",function(a,b){return{restrict:"A",require:"?ngModel",scope:{cardType:"=?"},link:function(c,d,e,f){function g(a){"number"==typeof a&&(b.cancel(i),i=b(function(){var b=a+1,c=d[0];if(c.setSelectionRange)c.focus(),c.setSelectionRange(a,b);else if(c.createTextRange){var e=c.createTextRange();e.collapse(!0),e.moveEnd("character",b),e.moveStart("character",a),e.select()}}))}function h(b){if(b){var c,d=a.fromNumber(b);return c=d?a.formatCardNumber(d,b):b.replace(/[^0-9 ]/g,""),c!==b&&(f.$setViewValue(c),f.$render(),g(c.length)),c}return void 0}if(f){(void 0===d.prop("id")||""===d.prop("id"))&&d.prop("id","cardNumber");var i;f.$validators.validCardNumber=function(b,e){var f=b||e,g=!1,h=a.fromNumber(f);if(h){c.cardType=h.type;var i=f.replace(/ /g,""),j=f.length-i.length;d.attr("minLength",h.length[0]+j),d.attr("maxLength",h.length[h.length.length-1]+j),a.numberValidForCard(h,f)&&(g=!0)}else c.cardType=void 0,d.attr("minLength",13),d.attr("maxLength",16);return d.prop("required")||(g=!0),g},f.$parsers.unshift(h),c.$watch(function(){return d.prop("required")},function(a){f.$validate()})}}}}]),a.directive("creditCardExpirationMonth",function(){return{restrict:"A",require:"?ngModel",scope:{expirationYear:"="},link:function(a,b,c,d){if(d){if("SELECT"==b.prop("tagName"))for(var e=["January","February","March","April","May","June","July","August","September","October","November","December"],f=0;f<e.length;f++){var g=f+1,h=angular.element('<option value="'+g+'">'+g+" - "+e[f]+"</option>");b.append(h)}(void 0===b.prop("id")||""===b.prop("id"))&&b.prop("id","cardExpirationMonth"),d.$validators.validExpirationMonth=function(c,d){var e=c||d,f=!0;if(a.expirationYear){var g=parseInt(a.expirationYear),h=new Date,i=parseInt(e)-1;g==h.getFullYear()&&i<=h.getMonth()&&(f=!1)}return b.prop("required")||(f=!0),f},a.$watch("expirationYear",function(){d.$validate()}),a.$watch(function(){return b.prop("required")},function(a){d.$validate()})}}}}),a.directive("creditCardExpirationYear",function(){return{restrict:"A",require:"?ngModel",link:function(a,b,c,d){if(d){if("SELECT"==b.prop("tagName"))for(var e=new Date,f=0;10>f;f++){var g=e.getFullYear()+f,h=angular.element('<option value="'+g+'">'+g+"</option>");b.append(h)}(void 0===b.prop("id")||""===b.prop("id"))&&b.prop("id","cardExpirationYear"),d.$validators.validExpirationYear=function(a,c){var d=a||c,e=new Date,f=parseInt(d),g=f<e.getFullYear()?!1:!0;return b.prop("required")||(g=!0),g},a.$watch(function(){return b.prop("required")},function(a){d.$validate()})}}}}),a.directive("autofillExpirationFields",function(){var a="width: 1px; height: 1px; margin-left: -1000px; position: fixed; display: block;";return{restrict:"E",scope:{},template:'<input style="'+a+'" ng-model="afmonth" id="cardExpirationMonth" maxlength="2" ng-change="update()" type="text"><input style="'+a+'" id="cardExpirationYear" ng-model="afyear" maxlength="4" ng-change="update()" type="text">',link:function(a,b,c){a.update=function(){a.$parent.$emit("autofill-date",{year:a.afyear||"",month:a.afmonth||""})}}}}),a.directive("creditCardExpirationEntry",["$compile",function(a){return{restrict:"A",require:"?ngModel",scope:{year:"=",month:"=",yearDigits:"@?",ngModel:"="},link:function(b,c,d,e){function f(a){if(a){var b=a.replace(/[^0-9]/g,"");return 1==b.length&&"0"!=b.substr(0,1)&&"1"!=b.substr(0,1)&&(b=""),2==b.length?"1"==b.substr(0,1)&&parseInt(b.substr(1,1),10)>2?b=b.substr(0,1):a.length>=3&&"/"==a.substr(2,1)&&(b=a.substr(0,3)):b.length>2&&(b=b.substr(0,2)+"/"+b.substr(2),b=b.substr(0,3+i)),b!==a&&(e.$setViewValue(b),e.$render()),b}return void 0}function g(a){var b;if(a){var c=a.replace(/[^0-9]/g,"");c.length>=2&&(b=parseInt(c.substr(0,2),10))}return b}function h(a){var b;if(a){var c=a.replace(/[^0-9]/g,"");c.length==2+i&&(b=2==i?2e3+parseInt(c.substr(2,i),10):parseInt(c.substr(2,i),10))}return b}var i=d.yearDigits?parseInt(d.yearDigits):2;if(e){var j=a("<autofill-expiration-fields></autofill-expiration-fields>"),k=j(b);c.parent().append(k),b.$on("autofill-date",function(a,b){if(4==b.year.length&&b.month.length>=1){var c="";c=1==b.month.length?"0"+b.month:b.month,c+="/",c+=2==i?b.year.substr(2):b.year,e.$setViewValue(c),e.$render()}}),e.$validators.validExpirationDate=function(a,b){var d=a||b,e=h(d),f=g(d),i=!1;if(void 0!==e&&void 0!==f){var j=new Date;e>j.getFullYear()?i=!0:e==j.getFullYear()&&f>j.getMonth()+1&&(i=!0)}return c.prop("required")||(i=!0),i},e.$parsers.unshift(f),b.$watch(function(){return e.$modelValue},function(a){a?(b.month=""+g(a),b.year=""+h(a)):(b.month=void 0,b.year=void 0)})}}}}]),a.directive("creditCardInformation",["$mvConfiguration","creditCards",function(a,b){return{restrict:"E",templateUrl:function(b,c){var d="";return d=void 0!==c.templateUrl?c.templateUrl:void 0!==c.typeExpiration?a.templateBasePath+"credit-card-information-type-expiration.html":a.templateBasePath+"credit-card-information.html"},scope:{cardholderName:"=",cardNumber:"=",cardType:"=?",expirationMonth:"=",expirationYear:"=",securityCode:"=",saveCard:"=?",cardRequired:"=?"},link:function(a,b,c){a.state={months:[],allowCardSave:void 0===a.saveCard?!1:!0,required:!0},a.$watch("cardRequired",function(b){a.state.required=void 0===b?!0:b})}}}])}(),function(){var a=angular.module("mv.configuration",[]);a.provider("$mvConfiguration",function(){var a={options:{templateBasePath:"defaultTemplatePath"},setTemplateBasePath:function(a){this.options.templateBasePath=a},$get:["$injector",function(a){var b={templateBasePath:this.options.templateBasePath};return b}]};return a})}(),function(){var a=angular.module("mv.facebook",[]);a.provider("$mvFacebookConfiguration",function(){function a(a,b){void 0===b&&(b="en_US"),void 0===a&&(a=!1);var c="//connect.facebook.net/"+b+"/";return c+=a?"all/debug.js":"all.js"}var b={options:{applicationID:"",redirectURL:"",language:"en_US",debug:!1,facebookScriptURL:"//connect.facebook.net/en_US/all.js",scope:"email",fields:"email,first_name,last_name,name"},setLoginRequiredScope:function(a){this.options.scope=a},setDebugMode:function(a){this.options.debug=a},setApplicationID:function(a){this.options.applicationID=a},setRedirectURL:function(a){this.options.redirectURL=a},setLanguage:function(a){this.options.language=a},setFields:function(a){this.options.fields=a},$get:["$injector",function(b){var c={applicationID:this.options.applicationID,redirectURL:this.options.redirectURL,facebookScriptURL:a(this.options.debug,this.options.language),scriptDOMElementID:"facebook-sdk-script",scope:this.options.scope,fields:this.options.fields};return c}]};return b}),a.service("loadFacebookJavascript",["$window","$q","$mvFacebookConfiguration",function(a,b,c){function d(){if(!document.getElementById(c.scriptDOMElementID)){var a=document.createElement("script");a.id=c.scriptDOMElementID,a.src=c.facebookScriptURL,document.body.appendChild(a)}}var e=b.defer();if(a.fbAsyncInit=function(){FB.init({appId:c.applicationID,status:!0,cookie:!0,xfbml:!0,redirect_url:c.redirectURL}),e.resolve()},!c.applicationID||0===c.applicationID.length)throw alert("You must configure the facebook application id!"),new Error("You must configure the facebook application id!");if(!c.redirectURL||0===c.redirectURL.length)throw alert("You must configure the facebook redirect URL!"),new Error("You must configure the facebook redirect URL!");return d(),e.promise}]),a.directive("facebookLoginButton",["loadFacebookJavascript","$timeout","$parse","$mvFacebookConfiguration",function(a,b,c,d){return{restrict:"A",link:function(e,f,g){if(!g.facebookLoginButton)throw new Error("You must supply a facebook callback");var h=c(g.facebookLoginButton);a.then(function(){f.on("click",function(){FB.login(function(a){a.authResponse?FB.api("/me",{fields:d.fields},function(a){b(function(){h(e,{status:"success",response:a})},50)}):b(function(){h(e,{status:"cancelled",response:a})},50)},{scope:d.scope,auth_type:"rerequest"})})},function(){h(e,{status:"loadingError",response:{}})})}}}]),a.directive("facebookPostButton",["loadFacebookJavascript","$timeout","$parse","$mvFacebookConfiguration",function(a,b,c,d){return{restrict:"A",link:function(e,f,g){function h(){FB.ui({method:"feed",link:g.shareLink,picture:g.shareImage,name:g.shareName,description:g.shareDescription},function(a){b(function(){a?j(e,{status:"success",response:a}):j(e,{status:"cancelled",response:a})},50)})}function i(){k&&FB.api("/me",{fields:d.fields},function(a){b(function(){k(e,{status:"success",response:a})},50)})}if(!g.facebookPostButton)throw new Error("You must supply a facebook callback");var j=c(g.facebookPostButton),k=null;g.loginCallback&&(k=c(g.loginCallback)),a.then(function(){f.on("click",function(){FB.getLoginStatus(function(a){"connected"==a.status?h():FB.login(function(a){a.authResponse?(h(),i()):b(function(){j(e,{status:"cancelled",response:a})},50)},{scope:d.scope})})})},function(){j(e,{status:"loadingError",response:{}})})}}}]),a.factory("facebookDetails",["$q","loadFacebookJavascript",function(a,b){function c(c,d){var e=a.defer();return b.then(function(){window.FB.api("/me/picture?height="+c+"&width="+d+"&redirect=false",function(a){a&&!a.error?a.data.is_silhouette?e.reject("No profile image or only default silhouette available"):e.resolve(a.data.url):e.reject("Error with API")})}),e.promise}return{getPhoto:function(a,b){return c(a,b)}}}])}(),function(){var a=angular.module("mv.filters",[]);a.filter("capitalize",function(){return function(a,b){return null!=a&&(a=a.toLowerCase()),a.substring(0,1).toUpperCase()+a.substring(1)}}),a.filter("max",function(){return function(a,b){a=a||"";var c=parseInt(a);return c>b&&(c=b),""+c}})}(),function(){var a=angular.module("mv.forms",["mv.configuration","mv.widgets"]);a.service("mvCountryLoader",["$http","$q","$mvConfiguration",function(a,b,c){var d=b.defer(),e=a.get(c.templateBasePath+"countries.json");return void 0!==e.success?(e.success(function(a){d.resolve(a)}),e.error(function(a){d.reject(a)})):e.then(function(a){d.resolve(a.data)},function(a,b){d.reject(b)}),d.promise}]),a.directive("postalCode",function(){return{require:"?ngModel",restrict:"A",scope:{countryCode:"=postalCode"},link:function(a,b,c,d){function e(b){if("US"==a.countryCode){if(b){var c=b.replace(/[^0-9 \-]/g,"");return c!==b&&(d.$setViewValue(c),d.$render()),c}return void 0}return b}function f(c,d){var e=c||d,f=!1;if("US"==a.countryCode){var g=e?e.replace(/[^0-9]/g,""):"";f=9==g.length||5==g.length?!0:!1}else f=!0;return b.prop("required")||(f=!0),f}d&&(d.$validators.validUSZip=f,d.$parsers.unshift(e),a.$watch("countryCode",function(a,c){"US"==a?b.prop("placeholder")&&b.prop("placeholder","Zip"):void 0!==a&&b.prop("placeholder")&&b.prop("placeholder","Postal Code"),d.$validate()}),a.$watch(function(){return b.prop("required")},function(a){d.$validate()}))}}}),a.directive("mvAddress",["$mvConfiguration","$q","$http","mvCountryLoader",function(a,b,c,d){function e(a,b){var c=null;if(void 0!==a){var d=a.trim().toLowerCase();angular.forEach(b,function(a){(d==a.Abbreviation.toLowerCase()||d==a.Name.toLowerCase())&&(c=a)})}return c}return{restrict:"E",templateUrl:function(b,c){var d="";return d=void 0!==c.templateUrl?c.templateUrl:a.templateBasePath+"address-elements.html"},scope:{street:"=",street2:"=?",city:"=",state:"=",zip:"=",country:"=",requiredFields:"=",useStreet2:"=?",fieldChanged:"&?",filterCountries:"&?"},link:function(a,b,c){function f(){if(i[a.country])a.state=i[a.country];else if(void 0!==a.countryObject&&a.countryObject.States){var b=e(a.state,a.countryObject.States);b&&(a.state=b.Abbreviation)}else a.state=""}function g(b){if(void 0===a.countryObject||b!=a.countryObject.Code){var c=!1;angular.forEach(a.countries,function(d){d.Code==b&&(a.countryObject=d,c=!0)}),c||window.console.log("Change the country object; country "+b+" NOT FOUND!")}}function h(){d.then(function(b){if(c.filterCountries){var d=[];angular.forEach(b,function(b){a.filterCountries({country:b})&&d.push(b)}),a.countries=d}else a.countries=b;var e=!1,f=!1;angular.forEach(a.countries,function(b){"US"==b.Code&&(f=!0),a.country==b.Code&&(e=!0)}),e?g(a.country):a.country=c.defaultCountryCode?c.defaultCountryCode:f?"US":a.countries[0].Code})}var i={};a.countries=[],a.disabled=!1,void 0!==c.ngDisabled&&a.$parent.$watch(c.ngDisabled,function(b){a.disabled=b}),a.street||(a.street=""),a.useStreet2&&!a.street2&&(a.street2=""),a.city||(a.city=""),a.state||(a.state=""),a.zip||(a.zip=""),a.state&&a.country&&(i[a.country]=a.state),a.sendChange=function(b,d,e){a.fieldChanged&&a.fieldChanged({field:c[b],newValue:d,oldValue:e})},a.$watch("country",function(a){void 0!==a&&g(a)}),a.$watch("countryObject.Code",function(b){void 0!==b&&b!=a.country&&(a.country=b,f())}),a.$watch("state",function(b,c){b!==c&&(i[a.country]=b)}),a.stateRequired=function(){var b=!1;return void 0!==a.countryObject&&(b=a.countryObject.States&&a.countryObject.States.length>0?a.requiredFields&&a.requiredFields.state:!1),b},h(),a.$on("mv-reload-countries",function(){h()})}}}])}(),function(){var a=angular.module("mv.upload.button",[]);a.directive("mvInlineUploadButton",["$q","$http","$parse",function(a,b,c){return{restrict:"A",scope:!0,link:function(d,e,f){function g(){var a=e.find("input[type=file]");a.wrap("<form>").closest("form").get(0).reset(),a.unwrap()}function h(a){p&&p.assign(d,a)}function i(){return a(function(a,c){b.post(f.endpointUrl,{verb:"upload-complete",id:f.identifier,bucket:l.uploadBucket,key:l.uploadKey,type:f.type,mimeType:l.mimeType}).then(function(b){b.data.success?a(b.data):(alert(b.data.message),c())},c)})}function j(a,c){b.post(f.endpointUrl,{verb:"upload-parameters",filename:a,id:f.identifier,type:f.type,mimeType:c}).then(function(a){a.data.success?(l={postURL:a.data.result.url,uploadBucket:a.data.result.bucket,uploadParameters:a.data.result.params,uploadKey:a.data.result.params.key,mimeType:a.data.result.mimeType},h(!0),k().then(function(a){i().then(function(a){n&&n(d,a.result),h(!1),g()},function(a){h(!1),g()})},function(a){switch(a.reason){case"loadFailed":alert("There was an error attempting to upload the file."+a.evt.response);break;case"error":alert("There was an error attempting to upload the file."+a.evt.response);break;case"aborted":alert("The upload has been canceled by the user or the browser dropped the connection.")}h(!1),g()})):(alert(a.data.message),g())})}function k(){return a(function(a,b){var c=new FormData;for(var f in l.uploadParameters)c.append(f,l.uploadParameters[f]);c.append("success_action_status",201);var g=e.find("input[type=file]").get(0).files[0];c.append("file",g);var h=new XMLHttpRequest;h.upload.addEventListener("progress",function(a){if(a.lengthComputable){var b=Math.round(100*a.loaded/a.total);o&&b!=o(d)&&d.$apply(function(){o.assign(d,b)})}},!1),h.addEventListener("load",function(c){d.$apply(c&&201==c.currentTarget.status?function(){a()}:function(){b({reason:"loadFailed",evt:c.currentTarget})})},!1),h.addEventListener("error",function(a){d.$apply(function(){b({reason:"error",evt:a})})},!1),h.addEventListener("abort",function(a){d.$apply(function(){b({reason:"aborted"})})},!1),o&&o.assign(d,0),h.open("POST",l.postURL,!0),h.send(c)})}e.addClass("upload_button"),e.append('<input type="file" accept="'+f.accept+'">');var l=null,m=null,n=null,o=null,p=null;f.previewImageSrc&&(m=c(f.previewImageSrc)),f.onCompletion&&(n=c(f.onCompletion)),f.uploadProgress&&(o=c(f.uploadProgress)),f.uploading&&(p=c(f.uploading)),e.find("input[type=file]").on("change",function(){if($(this).val()){var a=this.files?this.files:[];if(a.length){{var b=$(this).val();f.identifier}if(b){var c=a[0].name,e=a[0].type,h=f.accept.split("/"),i=e.split("/"),k=!0;if(h.length==i.length)for(var l=0;l<h.length;l++)h[l]!=i[l]&&"*"!=h[l]&&(k=!1);if(k)if(window.FileReader)if(/^image/.test(e)){var n=f.minImageWidth||0,o=f.minImageHeight||0,p=new FileReader;p.onloadend=function(){var a=this.result;if(n||o){var b=new Image;b.onload=function(){if(n&&this.width<n||o&&this.height<o){var a=[];a.push("This image is too small."),n&&a.push("It must be at least "+n+" pixels wide (It is currently "+this.width+")"),o&&a.push("It must be at least "+o+" pixels tall (It is currently "+this.height+")"),alert(a.join("\n")),g()}else d.$apply(function(){j(c,e)})},b.src=a}d.$apply(function(){m.assign(d,a),n||o||j(c,e)})},p.readAsDataURL(a[0])}else f.defaultPreviewImage?(m.assign(d,f.defaultPreviewImage),j(c,e)):j(c,e);else j(c,e);else{var q="Invalid file type!";if(h.length)switch(h[0]){case"video":q="The selected file is not a valid video file.";break;case"image":q="The selected file is not a valid image file.";break;case"audio":q="The selected file is not a valid audio file."}alert(q),g()}}}}})}}}]),a.directive("mvUploadButtonWithProgress",["$q","$http",function(a,b){return{restrict:"E",scope:{title:"@",accept:"@",type:"@",identifier:"@",endpointUrl:"@",previewImageSrc:"=?",onCompletion:"&?",minImageWidth:"@?",minImageHeight:"@?",uploading:"=?"},template:'<div><progressbar ng-show="state.uploading" style="width: 100%;" value="state.progress"></progressbar><span ng-show="!state.uploading" class="btn btn-file btn-default btn-sm" mv-inline-upload-button type="{{ type }}" accept="{{ accept }}" identifier="{{ identifier }}" endpoint-url="{{ endpointUrl }}" preview-image-src="state.previewImageSrc" on-completion="complete(bucket, key, url)" upload-progress="state.progress" uploading="state.uploading" min-image-width="{{ minImageWidth }}" min-image-height="{{ minImageHeight }}" >{{ title }}</span></div>',link:function(a,b,c){a.state={uploading:!1,progress:0,previewImageSrc:null},a.$watch("state.previewImageSrc",function(b){a.previewImageSrc&&(a.previewImageSrc=b)}),c.uploading&&a.$watch("state.uploading",function(b){a.uploading=b}),a.complete=function(b,c,d){a.onCompletion&&a.onCompletion({bucket:b,key:c,url:d})}}}}])}(),function(){var a=angular.module("mv.utils",["mv.filters","mv.configuration","ui.bootstrap"]);a.directive("flagCheckbox",["$timeout",function(a){return{restrict:"A",scope:{flags:"=",flag:"@flagCheckbox"},link:function(b,c,d){var e=parseInt(b.flag);b.$watch("flags",function(a){void 0!==a&&(c[0].checked=a&e?!0:!1)}),c.on("click",function(){a(function(){c[0].checked?b.flags|=e:b.flags&=~e},1)})}}}]),a.directive("compareTo",function(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(a,b,c,d){d.$validators.compareTo=function(b){return b==a.otherModelValue},a.$watch("otherModelValue",function(){d.$validate()})}}}),a.service("Dialogs",["$uibModal","$sce","$mvConfiguration",function(a,b,c){this.Confirm=function(d,e,f){return a.open({controller:["$scope","$uibModalInstance","message","title","buttons",function(a,c,d,e,f){a.message=b.trustAsHtml(d),a.title=e,a.buttons=f,a.clickButton=function(a){"cancel"==a.type?c.dismiss(a.name):c.close(a)}}],templateUrl:c.templateBasePath+"dialogs/confirm-modal.html",resolve:{message:function(){return d},buttons:function(){return void 0===f?[{name:"OK",type:"ok"},{name:"Cancel",type:"cancel"}]:f},title:function(){return void 0===e?"Confirm":e}}}).result},this.SingleTextAreaEntry=function(d,e,f){return a.open({controller:["$scope","$uibModalInstance","$mvConfiguration","message","title","buttons",function(a,c,d,e,f,g){a.message=b.trustAsHtml(e),a.title=f,a.buttons=g,a.params={textAreaEntry:""},a.clickButton=function(b){"cancel"==b.type?c.dismiss(b.name):c.close({button:b,textAreaEntry:a.params.textAreaEntry})}}],templateUrl:c.templateBasePath+"dialogs/single-text-area-modal.html",resolve:{message:function(){return d},buttons:function(){return void 0===f?[{name:"OK",type:"ok"},{name:"Cancel",type:"cancel"}]:f},title:function(){return void 0===e?"Confirm":e}}}).result}}]),a.service("UtilService",function(){this.CalculateTimeDeltas=function(a,b){var c=new Date,d=null,e=null;b&&(b instanceof Date?d=b:"0000-00-00"!=b&&(d=Date.parse(b))),e=a?a instanceof Date?a:Date.parse(a):c;var f={days:0,hours:0,minutes:0,seconds:0,timeUnits:"",timeValue:""};if(null!=d){var g=c>e?c:e;if(d>g){var h=Math.abs(d-g)/1e3,i=Math.floor(h/86400);h-=86400*i;var j=Math.floor(h/3600)%24;h-=3600*j;var k=Math.floor(h/60)%60;h-=60*k;var l=h%60;f.days=i,f.hours=j,f.minutes=k,f.seconds=l,i>0?(f.timeValue=i,f.timeUnits=1==i?"day left":"days left"):j>0?(f.timeValue=j,f.timeUnits=1==j?"hour left":"hours left"):k>0?(f.timeValue=k,f.timeUnits=1==k?"minute left":"minutes left"):l>0&&(f.timeValue=l,f.timeUnits=1==l?"second left":"seconds left")}else f.timeValue=""}else f.timeValue="Unknown",f.timeUnits="days left";return f}}),a.directive("onlyDigits",function(){return{restrict:"EA",require:"?ngModel",link:function(a,b,c,d){d&&d.$parsers.unshift(function(a){var b=!1,e=a.split("").filter(function(a,d){var e=!isNaN(a)&&" "!=a;return!e&&c.allowDecimal&&"true"==c.allowDecimal&&"."==a&&b===!1&&(b=!0,e=!0),!e&&c.allowNegative&&"true"==c.allowNegative&&(e="-"==a&&0===parseInt(d)),e}).join("");return c.maxNum&&!isNaN(c.maxNum)&&parseFloat(e)>parseFloat(c.maxNum)&&(e=c.maxNum),c.minNum&&!isNaN(c.minNum)&&parseFloat(e)<parseFloat(c.minNum)&&(e=c.minNum),d.$setViewValue(e),d.$render(),e})}}}),a.directive("onlyNumber",function(){return{require:"ngModel",restrict:"AC",link:function(a,b,c,d){function e(a){if(a){var b=a.replace(/[^0-9]/g,"");return b!==a&&(d.$setViewValue(b),d.$render()),parseInt(b,10)}return void 0}d.$parsers.push(e)}}}),a.directive("thousandsComma",["$filter",function(a){return{require:"?ngModel",link:function(b,c,d,e){function f(b){var d,e;return""!==b?(e=b.replace(/[\,\.]/g,""),d=a("number")(e),c.val(d)):(d="",e=""),c.val(d),e}function g(a){if(a){var b=a.replace(/[^0-9\,]/g,"");return b!==a&&(e.$setViewValue(b),e.$render()),b}return void 0}e&&(e.$formatters.unshift(function(){return""!==e.$modelValue?a("number")(e.$modelValue):""}),e.$parsers.unshift(f),e.$parsers.unshift(g))}}}]),a.directive("mvEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.mvEnter)}),b.preventDefault())})}}),/**
		 * angular-elastic-input
		 * A directive for AngularJS which automatically resizes the width of input field according to the content, while typing.
		 * @author: Jacek Pulit <jacek.pulit@gmail.com>
		 * @license: MIT License
		 */
a.directive("mvElasticInput",function(){return{require:"?ngModel",restrict:"A",link:function(a,b,c,d){function e(){g.text(c.placeholder?b.val()||c.placeholder:b.val()),b.css("width",g.outerWidth()+1)}var f=angular.element('<div style="position:fixed; top:-999px; left:0;"></div>'),g=angular.element('<span style="white-space:pre;"></span>'),h="none"===b.css("maxWidth")?b.parent().innerWidth():b.css("maxWidth");b.css("minWidth",c.mvElasticInputMinwidth||b.css("minWidth")),b.css("maxWidth",c.mvElasticInputMaxwidth||h),angular.forEach(["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent","boxSizing","borderRightWidth","borderLeftWidth","borderLeftStyle","borderRightStyle","paddingLeft","paddingRight","marginLeft","marginRight"],function(a){g.css(a,b.css(a))}),angular.element("body").append(f.append(g)),e(),d?a.$watch(c.ngModel,function(){e()}):b.on("keydown keyup focus input propertychange change",function(){e()})}}})}(),function(){var a=angular.module("mv.widgets",[]);a.directive("showValidationIcon",function(){return{restrict:"A",require:"?ngModel",link:function(a,b,c,d){function e(a,b){a?b?(void 0!==f&&f.removeClass("has-error").addClass("has-success"),void 0!==i&&i.removeClass("hidden").removeClass("glyphicon-remove").addClass("glyphicon-ok")):(void 0!==f&&f.removeClass("has-success").addClass("has-error"),void 0!==i&&i.removeClass("hidden").removeClass("glyphicon-ok").addClass("glyphicon-remove")):(void 0!==f&&f.removeClass("has-success").removeClass("has-error"),void 0!==i&&i.addClass("hidden"))}if(d){for(var f,g=void 0!==c.delayValidation?!1:!0,h=b.parent();h.length>0;){if(h.hasClass("form-group")){h.addClass("has-feedback"),f=h;break}h=h.parent()}var i;"INPUT"!=b.prop("tagName")||void 0!==f&&f.hasClass("input-group")||(i=angular.element('<span class="form-control-feedback glyphicon glyphicon-ok hidden"></span>'),b.after(i)),a.$watch(function(){return d.$dirty+"-"+d.$valid+"-"+d.$touched},function(){var a=g&&d.$dirty||d.$touched;e(a,d.$valid)})}}}}),a.directive("flashAlert",["$timeout",function(a){return{restrict:"E",scope:{type:"=",message:"=",duration:"=?"},template:'<div ng-show="message" class="alert" ng-class="alertClass"><button type="button" class="close" ng-click="visible= false">x</button><strong>{{ strongText }}</strong> <span ng-bind-html="message"></span></div>',link:function(b,c,d){b.$watch("type",function(){if(b.type)switch(b.type){case"info":b.alertClass="alert-info",b.strongText="";break;case"warning":b.alertClass="alert-warning",b.strongText="Warning:";break;case"error":b.alertClass="alert-danger",b.strongText="Error:";break;case"success":b.alertClass="alert-success",b.strongText=""}}),b.$watch("message",function(c){if(c){var d=b.duration||5e3;a(function(){b.message=void 0},d)}})}}}]),a.directive("itemExpander",function(){return{restrict:"E",transclude:!0,scope:{title:"@",expanded:"=?"},template:'<h4><a href="#" ng-click="toggle($event)"><span class="glyphicon" ng-class="iconClass"></span>{{ title }}</a></h4><div ng-show="expanded"><ng-transclude></ng-transclude></div>',link:function(a,b,c){a.toggle=function(b){b.preventDefault(),a.expanded=!a.expanded},a.$watch("expanded",function(b){a.iconClass=b?"glyphicon-collapse-down":"glyphicon-collapse-up"})}}}),a.directive("audioPlayer",function(){return{restrict:"E",link:function(a,b,c){c.audioUrl?(b.append('<div id="'+c.containerId+'">Loading the player...</div>'),jwplayer(c.containerId).setup({file:c.audioUrl,supplied:"mp3",width:"100%",height:30})):b.append('<p class="text-center h4">This audio is still processing on the server.<br/>Please refresh this page in a few minutes.</p>')}}}),a.directive("videoPlayer",function(){return{restrict:"E",link:function(a,b,c){c.videoUrl?(b.append('<div id="'+c.containerId+'">Loading the player...</div>'),jwplayer(c.containerId).setup({file:c.videoUrl,image:c.imageUrl,width:"100%",aspectratio:c.width+":"+c.height,stretching:"exactfit"})):b.append('<p class="text-center h4">This video is still processing on the server.<br/>Please refresh this page in a few minutes to view.</p>')}}})}();