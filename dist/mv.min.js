!function(){function a(a,b,c){var d=a.$parsers.indexOf(b),e=!1;c&&d<0?(a.$parsers.unshift(b),e=!0):!c&&d>=0&&(a.$parsers.splice(d,1),e=!0),e&&a.$validate()}var b=angular.module("mv.banking.kyc",["mv.widgets","mv.configuration"]);b.factory("kycPersonalIdProvider",["$q",function(a){function b(a,b){var c;switch(a){case"US":c="internal"==b?{pattern:"\\d{9}",label:"Social Security Number (9 Digits)",maxLength:9,placeholder:"123-45-6789",digitsOnly:!0}:{pattern:"\\d{4}",label:"Social Security Number (Last 4 Digits)",maxLength:4,placeholder:"1234",digitsOnly:!0};break;case"MY":c={pattern:".*",label:"Income Tax Number (ITN)",maxLength:20,placeholder:""};break;case"NZ":c={pattern:".*",label:"Inland Revenue Department (IRD) Number",maxLength:20,placeholder:""};break;case"AU":c={pattern:".*",label:"Tax File Number (TFN)",maxLength:20,placeholder:""};break;case"TR":case"PS":c={pattern:".*",label:"Tax Identification Number (TIN)",maxLength:20,placeholder:""};break;case"ID":c={pattern:".*",label:"Nomor Pokok Wajib Pajak (NPWP)",maxLength:20,placeholder:""};break;case"SG":c={pattern:".*",label:"UEN",maxLength:20,placeholder:""};break;case"CA":c={pattern:"\\d{9}",label:"Social Insurance Number (SIN)",maxLength:9,placeholder:"123-456-789",digitsOnly:!0};break;case"GB":c={pattern:"[A-Za-z]{2}\\d{6}[A-Za-z0-9]{1}",label:"National Insurance Number (NIN)",description:"This should be a combination of 2 letters, 6 digits, and 1 letter.",maxLength:9,placeholder:"AB123456C"};break;default:c={pattern:".*",label:"Personal ID Number",maxLength:20,placeholder:"123456789"}}return void 0===c.digitsOnly&&(c.digitsOnly=!1),c}return{forCountryCode:b}}]),b.directive("kycPersonalIdLabel",["kycPersonalIdProvider",function(a){return{restrict:"E",scope:{countryCode:"="},replace:!0,template:"<span>{{ data.label }}</span>",link:function(b,c,d){var e=d.kycType||"external";b.data={label:"Personal ID Number"},b.$watch("countryCode",function(c){if(c){var d=a.forCountryCode(c,e);b.data.label=d.label}})}}}]),b.directive("kycPersonalIdForCountry",["kycPersonalIdProvider",function(b){return{restrict:"A",require:"ngModel",link:function(c,d,e,f){function g(a){if(a){var b=a.replace(/[^0-9]/g,"");return b!==a&&(f.$setViewValue(b),f.$render()),b}}var h=e.kycType||"external",i=null;if(!e.kycPersonalIdForCountry)return void console.log("Country code required");f.$validators.kycPersonalIdForCountry=function(a,b){if(!i)return!0;var c=!1,e=b||"";return e.length<=i.maxLength&&e.match(i.pattern)&&(c=!0),d.prop("required")||(c=!0),c},c.$watch(e.kycPersonalIdForCountry,function(c){c&&(i=b.forCountryCode(c,h))&&(d.attr("placeholder",i.placeholder),d.attr("maxlength",i.maxLength),d.attr("pattern",i.pattern),a(f,g,i.digitsOnly),f.$validate())})}}}]),b.directive("kycPersonalIdHelpBlockText",["kycPersonalIdProvider",function(a){return{restrict:"E",scope:{countryCode:"="},replace:!0,template:"<span>{{ data.description }}</span>",link:function(b,c,d){var e=d.kycType||"external";b.data={description:""},b.$watch("countryCode",function(c){if(c){var d=a.forCountryCode(c,e);d&&(d.description?b.data.description=d.description:b.data.description="")}})}}}])}(),function(){angular.module("mv.banking",["mv.widgets","mv.configuration","mv.banking.numbers.iban","mv.banking.numbers.account","mv.banking.numbers.routing","mv.banking.kyc"])}(),function(){function a(a,b,c){var d=a.$parsers.indexOf(b),e=!1;c&&d<0?(a.$parsers.unshift(b),e=!0):!c&&d>=0&&(a.$parsers.splice(d,1),e=!0),e&&a.$validate()}var b=angular.module("mv.banking.numbers.account",[]);b.factory("bankAccountNumberProvider",["$q",function(a){function b(a){var b;switch(a){case"US":b={pattern:"(\\d){3,}",label:"Account Number",maxLength:34,placeholder:"123456789",description:"This should be 3 or more digits and is found on the front of your check.",digitsOnly:!0};break;case"GB":b={pattern:"(\\d){8}",label:"Account Number",maxLength:8,placeholder:"12345678",description:"This should be 8 digits.",digitsOnly:!0};break;default:b={pattern:"(.){3,}",label:"Account Number",maxLength:34,placeholder:"12345678",description:"This should be 3 or more letters or digits.",digitsOnly:!1}}return b}return{forCountryCode:b}}]),b.directive("bankAccountNumberLabel",["bankAccountNumberProvider",function(a){return{restrict:"E",scope:{countryCode:"="},replace:!0,template:"<span>{{ data.label }}</span>",link:function(b,c,d){b.data={label:"Account Number"},b.$watch("countryCode",function(c){if(c){var d=a.forCountryCode(c);b.data.label=d.label}})}}}]),b.directive("bankAccountNumberForCountry",["bankAccountNumberProvider",function(b){return{restrict:"A",require:"ngModel",link:function(c,d,e,f){function g(a){if(a){var b=a.replace(/[^0-9]/g,"");return b!==a&&(f.$setViewValue(b),f.$render()),b}}var h=null;if(!e.bankAccountNumberForCountry)return void console.log("Country code required");f.$validators.bankAccountNumberForCountry=function(a,b){if(!h)return!1;var c=!1,e=b||"";return e.length<=h.maxLength&&e.match(h.pattern)&&(c=!0),d.prop("required")||(c=!0),c},c.$watch(e.bankAccountNumberForCountry,function(c){c&&(h=b.forCountryCode(c))&&(d.attr("placeholder",h.placeholder),d.attr("maxlength",h.maxLength),d.attr("pattern",h.pattern),a(f,g,h.digitsOnly),f.$validate())})}}}]),b.directive("bankAccountNumberHelpBlockText",["bankAccountNumberProvider",function(a){return{restrict:"E",scope:{countryCode:"="},replace:!0,template:"<span>{{ data.description }}</span>",link:function(b,c,d){b.data={description:""},b.$watch("countryCode",function(c){if(c){var d=a.forCountryCode(c);d&&(d.description?b.data.description=d.description:b.data.description="")}})}}}])}(),function(){var a=angular.module("mv.banking.numbers.iban",[]);a.factory("ibanProvider",["$q",function(a){function b(a){var b;switch(a){case"AL":b={pattern:"[A-Za-z]{2}\\d{2}\\d{8}[A-Za-z0-9]{16}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 10 digits, and then 16 numbers or characters.",maxLength:28,placeholder:"AL47212110090000000235698741"};break;case"AD":b={pattern:"[A-Za-z]{2}\\d{2}\\d{8}[A-Za-z0-9]{12}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 10 digits and then 12 numbers or characters.",maxLength:24,placeholder:"AD1200012030200359100100"};break;case"AT":b={pattern:"[A-Za-z]{2}\\d{18}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 18 digits.",maxLength:20,placeholder:"AT611904300234573201"};break;case"AZ":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z0-9]{4}\\d{20}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, then 4 characters, and finally 20 digits.",maxLength:28,placeholder:"AZ21NABZ00000000137010001944"};break;case"BH":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z]{4}[A-Za-z0-9]{14}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, then 4 characters, and finally 14 numbers or characters.",maxLength:22,placeholder:"BH67BMAG00001299123456"};break;case"BE":b={pattern:"[A-Za-z]{2}\\d{14}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 14 digits.",maxLength:16,placeholder:"BE68539007547034"};break;case"BA":b={pattern:"[A-Za-z]{2}\\d{18}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 18 digits.",maxLength:20,placeholder:"BA391290079401028494"};break;case"BR":b={pattern:"[A-Za-z]{2}\\d{2}\\d{23}[A-Za-z]{1}[A-Za-z0-9]{1}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 25 digits, a letter and then a number or letter.",maxLength:29,placeholder:"BR9700360305000010009795493P1"};break;case"BG":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z]{4}\\d{6}[A-Za-z0-9]{8}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 18 digits.",maxLength:22,placeholder:"BG80BNBG96611020345678"};break;case"CR":b={pattern:"[A-Za-z]{2}\\d{20}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 20 digits.",maxLength:22,placeholder:"CR05015202001026284066"};break;case"HR":b={pattern:"[A-Za-z]{2}\\d{19}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 19 digits.",maxLength:21,placeholder:"HR1210010051863000160"};break;case"CY":b={pattern:"[A-Za-z]{2}\\d{2}\\d{8}[A-Za-z0-9]{16}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 10 digits, then 16 letters or digits.",maxLength:28,placeholder:"CY17002001280000001200527600"};break;case"CZ":b={pattern:"[A-Za-z]{2}\\d{22}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 22 digits.",maxLength:24,placeholder:"CZ6508000000192000145399"};break;case"DK":b={pattern:"[A-Za-z]{2}\\d{16}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 16 digits.",maxLength:18,placeholder:"DK5000400440116243"};break;case"DO":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z]{4}\\d{20}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, then 4 letters and finally 20 letters or numbers.",maxLength:28,placeholder:"DO28BAGR00000001212453611324"};break;case"EE":b={pattern:"[A-Za-z]{2}\\d{18}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 18 digits.",maxLength:20,placeholder:"EE382200221020145685"};break;case"FO":b={pattern:"[A-Za-z]{2}\\d{16}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 16 digits.",maxLength:18,placeholder:"FO6264600001631634"};break;case"FI":b={pattern:"[A-Za-z]{2}\\d{16}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 16 digits.",maxLength:18,placeholder:"FI2112345600000785"};break;case"FR":b={pattern:"[A-Za-z]{2}\\d{12}[A-Za-z0-9]{11}\\d{2}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 12 digits, then 11 letters or digits and finally 2 digits.",maxLength:27,placeholder:"FR1420041010050500013M02606"};break;case"GE":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z0-9]{2}\\d{16}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, then 2 letters or digits and finally 16 digits.",maxLength:22,placeholder:"GE29NB0000000101904917"};break;case"DE":b={pattern:"[A-Za-z]{2}\\d{20}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 20 digits.",maxLength:22,placeholder:"DE89370400440532013000"};break;case"GI":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z]{4}[A-Za-z0-9]{15}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, then 4 letters and then 15 numbers or letters.",maxLength:23,placeholder:"GI75NWBK000000007099453"};break;case"GR":b={pattern:"[A-Za-z]{2}\\d{9}[A-Za-z0-9]{16}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 9 digits, then 16 letters or digits.",maxLength:27,placeholder:"GR1601101250000000012300695"};break;case"GL":b={pattern:"[A-Za-z]{2}\\d{16}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 16 digits.",maxLength:18,placeholder:"GL8964710001000206"};break;case"GT":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z0-9]{20}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, then 24 letters or numbers.",maxLength:28,placeholder:"GT82TRAJ01020000001210029690"};break;case"HU":b={pattern:"[A-Za-z]{2}\\d{26}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 26 digits.",maxLength:28,placeholder:"HU42117730161111101800000000"};break;case"IS":b={pattern:"[A-Za-z]{2}\\d{24}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 24 digits.",maxLength:26,placeholder:"IS140159260076545510730339"};break;case"IE":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z0-9]{4}\\d{14}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, then 4 letters or numbers, and finally 14 digits.",maxLength:22,placeholder:"IE29AIBK93115212345678"};break;case"IL":b={pattern:"[A-Za-z]{2}\\d{21}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 21 digits.",maxLength:23,placeholder:"IL620108000000099999999"};break;case"IT":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z]{1}\\d{10}[A-Za-z0-9]{12}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, then a letter, then 10 digits, and finally 12 letters or numbers.",maxLength:27,placeholder:"IT60X0542811101000000123456"};break;case"KZ":b={pattern:"[A-Za-z]{2}\\d{5}[A-Za-z0-9]{13}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 5 digits, and then 13 letters or numbers.",maxLength:20,placeholder:"KZ86125KZT5004100100"};break;case"KW":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z]{4}[A-Za-z0-9]{22}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, and then 4 letters and finally 22 letters or digits.",maxLength:30,placeholder:"KW81CBKU0000000000001234560101"};break;case"LV":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z]{4}[A-Za-z0-9]{13}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, and then 4 letters and finally 13 letters or digits.",maxLength:21,placeholder:"LV80BANK0000435195001"};break;case"LB":b={pattern:"[A-Za-z]{2}\\d{6}[A-Za-z0-9]{20}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 6 digits, and then 20 letters or digits.",maxLength:28,placeholder:"LB62099900000001001901229114"};break;case"LI":b={pattern:"[A-Za-z]{2}\\d{7}[A-Za-z0-9]{12}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 7 digits, and then 12 letters or digits.",maxLength:21,placeholder:"LI21088100002324013AA"};break;case"LT":b={pattern:"[A-Za-z]{2}\\d{18}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 18 digits.",maxLength:20,placeholder:"LT121000011101001000"};break;case"LU":b={pattern:"[A-Za-z]{2}\\d{5}[A-Za-z0-9]{13}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 5 digits and then 13 numbers or letters.",maxLength:20,placeholder:"LU280019400644750000"};break;case"MK":b={pattern:"[A-Za-z]{2}\\d{5}[A-Za-z0-9]{10}\\d{2}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 5 digits and then 10 numbers or letters, and finally two digits.",maxLength:19,placeholder:"MK07250120000058984"};break;case"MT":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z]{4}\\d{5}[A-Za-z0-9]{18}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, then 4 letters,  then 5 digits, and finally 18 numbers or letters.",maxLength:31,placeholder:"MT84MALT011000012345MTLCAST001S"};break;case"MR":b={pattern:"[A-Za-z]{2}\\d{25}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 25 digits.",maxLength:27,placeholder:"MR1300020001010000123456753"};break;case"MU":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z]{4}\\d{19}[A-Za-z]{3}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, then 4 letters, 19 numbers, and finally 3 letters.",maxLength:30,placeholder:"MU17BOMM0101101030300200000MUR"};break;case"MC":b={pattern:"[A-Za-z]{2}\\d{12}[A-Za-z0-9]{11}\\d{2}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 12 digits, then 11 letters or numbers and finally 2 digits.",maxLength:27,placeholder:"MC5811222000010123456789030"};break;case"MD":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z0-9]{2}\\d{18}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, then 2 letters or numbers and finally 18 digits.",maxLength:24,placeholder:"MD24AG000225100013104168"};break;case"ME":b={pattern:"[A-Za-z]{2}\\d{20}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 20 digits.",maxLength:22,placeholder:"ME25505000012345678951"};break;case"NL":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z]{4}\\d{10}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, then 4 letters, and finally 10 digits.",maxLength:18,placeholder:"NL91ABNA0417164300"};break;case"NO":b={pattern:"[A-Za-z]{2}\\d{13}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 13 digits.",maxLength:15,placeholder:"NO9386011117947"};break;case"PK":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z0-9]{4}\\d{16}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, then 4 letters or numbers, and finally 16 digits.",maxLength:24,placeholder:"PK36SCBL0000001123456702"};break;case"PS":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z0-9]{4}\\d{21}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, then 4 letters or numbers, and finally 21 digits.",maxLength:29,placeholder:"PS92PALS000000000400123456702"};break;case"PL":b={pattern:"[A-Za-z]{2}\\d{26}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 26 digits.",maxLength:28,placeholder:"PL61109010140000071219812874"};break;case"PT":b={pattern:"[A-Za-z]{2}\\d{23}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 23 digits.",maxLength:25,placeholder:"PT50000201231234567890154"};break;case"RO":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z]{4}[A-Za-z0-9]{16}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, then 4 letters, and finally 16 letters or digits.",maxLength:24,placeholder:"RO49AAAA1B31007593840000"};break;case"SM":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z]{1}\\d{10}[A-Za-z0-9]{12}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, then 1 letter, then 10 digits, then finally 12 letters or digits.",maxLength:27,placeholder:"SM86U0322509800000000270100"};break;case"SA":b={pattern:"[A-Za-z]{2}\\d{4}[A-Za-z0-9]{18}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 4 digits, then 18 letters or digits.",maxLength:24,placeholder:"SA0380000000608010167519"};break;case"RS":b={pattern:"[A-Za-z]{2}\\d{20}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 20 digits.",maxLength:22,placeholder:"RS35260005601001611379"};break;case"SK":b={pattern:"[A-Za-z]{2}\\d{22}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 22 digits.",maxLength:24,placeholder:"SK3112000000198742637541"};break;case"SI":b={pattern:"[A-Za-z]{2}\\d{17}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 17 digits.",maxLength:19,placeholder:"SI56263300012039086"};break;case"ES":b={pattern:"[A-Za-z]{2}\\d{22}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 22 digits.",maxLength:24,placeholder:"ES9121000418450200051332"};break;case"SE":b={pattern:"[A-Za-z]{2}\\d{22}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 22 digits.",maxLength:24,placeholder:"SE4550000000058398257466"};break;case"CH":b={pattern:"[A-Za-z]{2}\\d{7}[A-Za-z0-9]{12}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 7 digits, and then 12 letters or numbers.",maxLength:21,placeholder:"CH9300762011623852957"};break;case"TN":b={pattern:"[A-Za-z]{2}\\d{22}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 22 digits.",maxLength:24,placeholder:"TN5910006035183598478831"};break;case"TR":b={pattern:"[A-Za-z]{2}\\d{7}[A-Za-z0-9]{17}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 7 digits, then 17 letters or numbers.",maxLength:26,placeholder:"TR330006100519786457841326"};break;case"AE":b={pattern:"[A-Za-z]{2}\\d{21}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 21 digits.",maxLength:23,placeholder:"AE070331234567890123456"};break;case"GB":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z]{4}\\d{14}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, then 4 letters, and then 14 digits.",maxLength:22,placeholder:"GB29NWBK60161331926819"};break;case"VG":b={pattern:"[A-Za-z]{2}\\d{2}[A-Za-z0-9]{4}\\d{16}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 2 digits, then 4 letters or numbers, and finally 16 digits.",maxLength:24,placeholder:"VG96VPVG0000012345678901"};break;default:b={pattern:"[A-Za-z]{2}\\d{20}",description:"This is the IBAN account number.  It should be a two letter country prefix followed by 20 digits.",maxLength:22,placeholder:"DE89370400440532013000",default:!0}}return b}return{forCountryCode:b,countrySupportsIBAN:function(a){return!b(a).default}}}]),a.directive("ibanNumberForCountry",["ibanProvider",function(a){return{restrict:"A",require:"ngModel",link:function(b,c,d,e){var f=null;if(!d.ibanNumberForCountry)return void console.log("Country code required");e.$validators.ibanNumberForCountry=function(a,b){if(!f)return!0;var d=!1,e=b||"";return e.length<=f.maxLength&&e.match(f.pattern)&&(d=!0),c.prop("required")||(d=!0),d},b.$watch(d.ibanNumberForCountry,function(b){b&&(f=a.forCountryCode(b))&&(c.attr("placeholder",f.placeholder),c.attr("maxlength",f.maxLength),c.attr("pattern",f.pattern),e.$validate())})}}}]),a.directive("ibanHelpBlockText",["ibanProvider",function(a){return{restrict:"E",scope:{countryCode:"="},replace:!0,template:"<span>{{ data.description }}</span>",link:function(b,c,d){b.data={description:""},b.$watch("countryCode",function(c){if(c){var d=a.forCountryCode(c);d&&(b.data=d)}})}}}])}(),function(){function a(a,b,c){var d=a.$parsers.indexOf(b),e=!1;c&&d<0?(a.$parsers.unshift(b),e=!0):!c&&d>=0&&(a.$parsers.splice(d,1),e=!0),e&&a.$validate()}var b=angular.module("mv.banking.numbers.routing",[]);b.factory("bankRoutingProvider",["$q",function(a){function b(a){var b;switch(a){case"US":b={pattern:"\\d{9}",label:"Routing Number",maxLength:9,placeholder:"123456789",description:"This should be 9 digits and is found on the front of your check.",digitsOnly:!0};break;case"CA":b={pattern:"0\\d{8}",label:"Routing Number",maxLength:9,placeholder:"012345678",description:"This should be 9 digits starting with a 0.",digitsOnly:!0};break;case"AU":b={pattern:"\\d{6}",label:"BSB",maxLength:6,placeholder:"123456",description:"This should be 6 digits.",digitsOnly:!0};break;case"GB":b={pattern:"\\d{6}",label:"Routing Number",maxLength:6,placeholder:"123456",description:"This should be 6 digits.",digitsOnly:!0};break;default:b={pattern:".{3,}",label:"Bank identifier, routing number, sort code, Swift, or BSB",maxLength:35,description:"This should be your bank's routing, Swift, sort code or BSB code",placeholder:"",digitsOnly:!1}}return b}return{forCountryCode:b}}]),b.directive("bankRoutingLabel",["bankRoutingProvider",function(a){return{restrict:"E",scope:{countryCode:"="},replace:!0,template:"<span>{{ data.label }}</span>",link:function(b,c,d){b.data={label:"Bank identifier, routing number, sort code, or BSB"},b.$watch("countryCode",function(c){if(c){var d=a.forCountryCode(c);b.data.label=d.label}})}}}]),b.directive("bankRoutingNumberForCountry",["bankRoutingProvider",function(b){return{restrict:"A",require:"ngModel",link:function(c,d,e,f){function g(a){if(a){var b=a.replace(/[^0-9]/g,"");return b!==a&&(f.$setViewValue(b),f.$render()),b}}var h=null;if(!e.bankRoutingNumberForCountry)return void console.log("Country code required");f.$validators.bankRoutingNumberForCountry=function(a,b){if(!h)return!0;var c=!1,e=b||"";return e.length<=h.maxLength&&e.match(h.pattern)&&(c=!0),d.prop("required")||(c=!0),c},c.$watch(e.bankRoutingNumberForCountry,function(c){c&&(h=b.forCountryCode(c))&&(d.attr("placeholder",h.placeholder),d.attr("maxlength",h.maxLength),d.attr("pattern",h.pattern),a(f,g,h.digitsOnly),f.$validate())})}}}]),b.directive("bankRoutingHelpBlockText",["bankRoutingProvider",function(a){return{restrict:"E",scope:{countryCode:"="},replace:!0,template:"<span>{{ data.description }}</span>",link:function(b,c,d){b.data={description:""},b.$watch("countryCode",function(c){if(c){var d=a.forCountryCode(c);d&&(d.description?b.data.description=d.description:b.data.description="")}})}}}])}(),function(){var a=angular.module("mv.billing",["mv.configuration","mv.widgets"]);a.factory("creditCards",[function(){function a(a){for(var b=!0,c=0,d=(a+"").split("").reverse(),e=0;e<d.length;e++){var f=parseInt(d[e],10);(b=!b)&&(f*=2),f>9&&(f-=9),c+=f}return c%10==0}var b=/(\d{1,4})/g,c=[{type:"discover",pattern:/^(6011|65|64[4-9]|622)/,format:b,length:[16],cvcLength:[3],luhn:!0},{type:"mastercard",format:b,pattern:/^5[1-5]/,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[4],luhn:!0},{type:"visa",pattern:/^4/,format:b,length:[13,14,15,16],cvcLength:[3],luhn:!0}];return{fromNumber:function(a){var b;for(a=(a+"").replace(/\D/g,""),b=0;b<c.length;b++){var d=c[b];if(d.pattern.test(a))return d}return null},fromType:function(a){var b;for(b=0;b<c.length;b++){var d=c[b];if(d.type===a)return d}},numberValidForCard:function(b,c){var d=(c+"").replace(/\D/g,""),e=!1;return b.length.indexOf(d.length)>=0&&(e=!b.luhn||a(d)),e},formatCardNumber:function(a,b){var c,d,e;if(!a)return b;if(d=a.length[a.length.length-1],b=b.replace(/\D/g,""),b=b.slice(0,+d+1||9e9),a.format.global)return null!=(e=b.match(a.format))?e.join(" "):void 0;if(null!=(c=a.format.exec(b))){c.shift();var f=[];angular.forEach(c,function(a){a&&f.push(a)}),c=f}return null!=c?c.join(" "):void 0},cvcValidForCard:function(a,b){var c=(b+"").replace(/\D/g,""),d=!1;return a.cvcLength.indexOf(c.length)>=0&&(d=!0),d}}}]),a.directive("creditCardCvv",["creditCards",function(a){return{restrict:"A",require:"?ngModel",scope:{cardNumber:"=creditCardCvv"},link:function(b,c,d,e){function f(a){if(a){var b=a.replace(/[^0-9]/g,"");return b!==a&&(e.$setViewValue(b),e.$render()),b}}e&&(void 0!==c.prop("id")&&""!==c.prop("id")||c.prop("id","cardCsc"),e.$validators.validSecurityCode=function(d,e){var f=!1,g=a.fromNumber(b.cardNumber);return f=!(!g||!a.cvcValidForCard(g,e)),c.prop("required")||(f=!0),f},e.$parsers.unshift(f),b.$watch(function(){return c.prop("required")},function(a){e.$validate()}),b.$watch("cardNumber",function(){var d=a.fromNumber(b.cardNumber);d?c.attr("maxLength",2==d.cvcLength.length?d.cvcLength[1]:d.cvcLength[0]):c.attr("maxLength",4),e.$validate()}))}}}]),a.directive("creditCardNumber",["creditCards","$timeout",function(a,b){return{restrict:"A",require:"?ngModel",scope:{cardType:"=?"},link:function(c,d,e,f){function g(a){"number"==typeof a&&(b.cancel(i),i=b(function(){var b=a+1,c=d[0];if(c.setSelectionRange)c.focus(),c.setSelectionRange(a,b);else if(c.createTextRange){var e=c.createTextRange();e.collapse(!0),e.moveEnd("character",b),e.moveStart("character",a),e.select()}}))}function h(b){if(b){var c,d=a.fromNumber(b);return c=d?a.formatCardNumber(d,b):b.replace(/[^0-9 ]/g,""),c!==b&&(f.$setViewValue(c),f.$render(),g(c.length)),c}}if(f){void 0!==d.prop("id")&&""!==d.prop("id")||d.prop("id","cardNumber");var i;f.$validators.validCardNumber=function(b,e){var f=b||e,g=!1,h=a.fromNumber(f);if(h){c.cardType=h.type;var i=f.replace(/ /g,""),j=f.length-i.length;d.attr("minLength",h.length[0]+j),d.attr("maxLength",h.length[h.length.length-1]+j),a.numberValidForCard(h,f)&&(g=!0)}else c.cardType=void 0,d.attr("minLength",13),d.attr("maxLength",16);return d.prop("required")||(g=!0),g},f.$parsers.unshift(h),c.$watch(function(){return d.prop("required")},function(a){f.$validate()})}}}}]),a.directive("creditCardExpirationMonth",function(){return{restrict:"A",require:"?ngModel",scope:{expirationYear:"="},link:function(a,b,c,d){if(d){if("SELECT"==b.prop("tagName"))for(var e=["January","February","March","April","May","June","July","August","September","October","November","December"],f=0;f<e.length;f++){var g=f+1,h=angular.element('<option value="'+g+'">'+g+" - "+e[f]+"</option>");b.append(h)}void 0!==b.prop("id")&&""!==b.prop("id")||b.prop("id","cardExpirationMonth"),d.$validators.validExpirationMonth=function(c,d){var e=c||d,f=!0;if(a.expirationYear){var g=parseInt(a.expirationYear),h=new Date,i=parseInt(e)-1;g==h.getFullYear()&&i<=h.getMonth()&&(f=!1)}return b.prop("required")||(f=!0),f},a.$watch("expirationYear",function(){d.$validate()}),a.$watch(function(){return b.prop("required")},function(a){d.$validate()})}}}}),a.directive("creditCardExpirationYear",function(){return{restrict:"A",require:"?ngModel",link:function(a,b,c,d){if(d){if("SELECT"==b.prop("tagName"))for(var e=new Date,f=0;f<10;f++){var g=e.getFullYear()+f,h=angular.element('<option value="'+g+'">'+g+"</option>");b.append(h)}void 0!==b.prop("id")&&""!==b.prop("id")||b.prop("id","cardExpirationYear"),d.$validators.validExpirationYear=function(a,c){var d=a||c,e=new Date,f=parseInt(d),g=!(f<e.getFullYear());return b.prop("required")||(g=!0),g},a.$watch(function(){return b.prop("required")},function(a){d.$validate()})}}}}),a.directive("autofillExpirationFields",function(){var a="width: 1px; height: 1px; margin-left: -1000px; position: fixed; display: block;";return{restrict:"E",scope:{},template:'<input style="'+a+'" ng-model="afmonth" id="cardExpirationMonth" maxlength="2" ng-change="update()" tabindex="-1" type="text"><input tabindex="-1" style="'+a+'" id="cardExpirationYear" ng-model="afyear" maxlength="4" ng-change="update()" type="text">',link:function(a,b,c){a.update=function(){a.$parent.$emit("autofill-date",{year:a.afyear||"",month:a.afmonth||""})}}}}),a.directive("creditCardExpirationEntry",["$compile",function(a){return{restrict:"A",require:"?ngModel",scope:{year:"=",month:"=",yearDigits:"@?",ngModel:"="},link:function(b,c,d,e){function f(a){if(a){var b=a.replace(/[^0-9]/g,"");return 1==b.length&&"0"!=b.substr(0,1)&&"1"!=b.substr(0,1)&&(b=""),2==b.length?"1"==b.substr(0,1)&&parseInt(b.substr(1,1),10)>2?b=b.substr(0,1):a.length>=3&&"/"==a.substr(2,1)&&(b=a.substr(0,3)):b.length>2&&(b=b.substr(0,2)+"/"+b.substr(2),b=b.substr(0,3+i)),b!==a&&(e.$setViewValue(b),e.$render()),b}}function g(a){var b;if(a){var c=a.replace(/[^0-9]/g,"");c.length>=2&&(b=parseInt(c.substr(0,2),10))}return b}function h(a){var b;if(a){var c=a.replace(/[^0-9]/g,"");c.length==2+i&&(b=2==i?2e3+parseInt(c.substr(2,i),10):parseInt(c.substr(2,i),10))}return b}var i=d.yearDigits?parseInt(d.yearDigits):2;if(e){var j=a("<autofill-expiration-fields></autofill-expiration-fields>"),k=j(b);c.parent().append(k),b.$on("autofill-date",function(a,b){if(4==b.year.length&&b.month.length>=1){var c="";c=1==b.month.length?"0"+b.month:b.month,c+="/",c+=2==i?b.year.substr(2):b.year,e.$setViewValue(c),e.$render()}}),e.$validators.validExpirationDate=function(a,b){var d=a||b,e=h(d),f=g(d),i=!1;if(void 0!==e&&void 0!==f){var j=new Date;e>j.getFullYear()?i=!0:e==j.getFullYear()&&f>j.getMonth()+1&&(i=!0)}return c.prop("required")||(i=!0),i
},e.$parsers.unshift(f),b.$watch(function(){return e.$modelValue},function(a){a?(b.month=""+g(a),b.year=""+h(a)):(b.month=void 0,b.year=void 0)})}}}}]),a.directive("creditCardInformation",["$mvConfiguration","creditCards",function(a,b){return{restrict:"E",templateUrl:function(b,c){return void 0!==c.templateUrl?c.templateUrl:void 0!==c.typeExpiration?a.templateBasePath+"credit-card-information-type-expiration.html":a.templateBasePath+"credit-card-information.html"},scope:{cardholderName:"=",cardNumber:"=",cardType:"=?",expirationMonth:"=",expirationYear:"=",securityCode:"=",saveCard:"=?",cardRequired:"=?"},link:function(a,b,c){a.state={months:[],allowCardSave:void 0!==a.saveCard,required:!0},a.$watch("cardRequired",function(b){a.state.required=void 0===b||b})}}}])}(),function(){angular.module("mv.configuration",[]).provider("$mvConfiguration",function(){return{options:{templateBasePath:"defaultTemplatePath"},setTemplateBasePath:function(a){this.options.templateBasePath=a},$get:["$injector",function(a){return{templateBasePath:this.options.templateBasePath}}]}})}(),function(){var a=angular.module("mv.facebook",[]);a.provider("$mvFacebookConfiguration",function(){function a(a,b){void 0===b&&(b="en_US"),void 0===a&&(a=!1);var c="//connect.facebook.net/"+b+"/";return c+=a?"sdk/debug.js":"sdk.js"}return{options:{applicationID:"",redirectURL:"",language:"en_US",debug:!1,facebookScriptURL:"//connect.facebook.net/en_US/all.js",scope:"email",fields:"email,first_name,last_name,name"},setLoginRequiredScope:function(a){this.options.scope=a},setDebugMode:function(a){this.options.debug=a},setApplicationID:function(a){this.options.applicationID=a},setRedirectURL:function(a){this.options.redirectURL=a},setLanguage:function(a){this.options.language=a},setFields:function(a){this.options.fields=a},$get:["$injector",function(b){return{applicationID:this.options.applicationID,redirectURL:this.options.redirectURL,facebookScriptURL:a(this.options.debug,this.options.language),scriptDOMElementID:"facebook-sdk-script",scope:this.options.scope,fields:this.options.fields}}]}}),a.service("loadFacebookJavascript",["$window","$q","$mvFacebookConfiguration",function(a,b,c){function d(){if(!document.getElementById(c.scriptDOMElementID)){var a=document.createElement("script");a.id=c.scriptDOMElementID,a.src=c.facebookScriptURL,document.body.appendChild(a)}}var e=b.defer();if(a.fbAsyncInit=function(){FB.init({appId:c.applicationID,status:!0,cookie:!0,xfbml:!0,version:"v2.9",redirect_url:c.redirectURL}),e.resolve()},!c.applicationID||0===c.applicationID.length)throw alert("You must configure the facebook application id!"),new Error("You must configure the facebook application id!");if(!c.redirectURL||0===c.redirectURL.length)throw alert("You must configure the facebook redirect URL!"),new Error("You must configure the facebook redirect URL!");return d(),e.promise}]),a.directive("facebookLoginButton",["loadFacebookJavascript","$timeout","$parse","$mvFacebookConfiguration",function(a,b,c,d){return{restrict:"A",link:function(e,f,g){if(!g.facebookLoginButton)throw new Error("You must supply a facebook callback");var h=c(g.facebookLoginButton);a.then(function(){f.on("click",function(){FB.login(function(a){a.authResponse?FB.api("/me",{fields:d.fields},function(a){b(function(){h(e,{status:"success",response:a})},50)}):b(function(){h(e,{status:"cancelled",response:a})},50)},{scope:d.scope,auth_type:"rerequest"})})},function(){h(e,{status:"loadingError",response:{}})})}}}]),a.directive("facebookPostButton",["loadFacebookJavascript","$timeout","$parse","$mvFacebookConfiguration",function(a,b,c,d){return{restrict:"A",link:function(e,f,g){function h(){FB.ui({method:"feed",link:g.shareLink,picture:g.shareImage,name:g.shareName,description:g.shareDescription},function(a){b(function(){a?j(e,{status:"success",response:a}):j(e,{status:"cancelled",response:a})},50)})}function i(){k&&FB.api("/me",{fields:d.fields},function(a){b(function(){k(e,{status:"success",response:a})},50)})}if(!g.facebookPostButton)throw new Error("You must supply a facebook callback");var j=c(g.facebookPostButton),k=null;g.loginCallback&&(k=c(g.loginCallback)),a.then(function(){f.on("click",function(){FB.getLoginStatus(function(a){"connected"==a.status?h():FB.login(function(a){a.authResponse?(h(),i()):b(function(){j(e,{status:"cancelled",response:a})},50)},{scope:d.scope})})})},function(){j(e,{status:"loadingError",response:{}})})}}}]),a.factory("facebookDetails",["$q","loadFacebookJavascript",function(a,b){function c(c,d){var e=a.defer();return b.then(function(){window.FB.api("/me/picture?height="+c+"&width="+d+"&redirect=false",function(a){a&&!a.error?a.data.is_silhouette?e.reject("No profile image or only default silhouette available"):e.resolve(a.data.url):e.reject("Error with API")})}),e.promise}return{getPhoto:function(a,b){return c(a,b)}}}])}(),function(){var a=angular.module("mv.filters",[]);a.filter("capitalize",function(){return function(a,b){return null!=a&&(a=a.toLowerCase()),a.substring(0,1).toUpperCase()+a.substring(1)}}),a.filter("max",function(){return function(a,b){a=a||"";var c=parseInt(a);return c>b&&(c=b),""+c}})}(),function(){var a=angular.module("mv.forms",["mv.configuration","mv.widgets"]);a.service("mvCountryLoader",["$http","$q","$mvConfiguration",function(a,b,c){var d=b.defer(),e=a.get(c.templateBasePath+"countries.json");return void 0!==e.success?(e.success(function(a){d.resolve(a)}),e.error(function(a){d.reject(a)})):e.then(function(a){d.resolve(a.data)},function(a,b){d.reject(b)}),d.promise}]),a.directive("postalCode",function(){return{require:"?ngModel",restrict:"A",scope:{countryCode:"=postalCode"},link:function(a,b,c,d){function e(b){if("US"!=a.countryCode)return b;if(b){var c=b.replace(/[^0-9 \-]/g,"");return c!==b&&(d.$setViewValue(c),d.$render()),c}}function f(c,d){var e=c||d,f=!1;if("US"==a.countryCode){var g=e?e.replace(/[^0-9]/g,""):"";f=9==g.length||5==g.length}else f=!0;return b.prop("required")||(f=!0),f}d&&(d.$validators.validUSZip=f,d.$parsers.unshift(e),a.$watch("countryCode",function(a,c){"US"==a?b.prop("placeholder")&&b.prop("placeholder","Zip"):void 0!==a&&b.prop("placeholder")&&b.prop("placeholder","Postal Code"),d.$validate()}),a.$watch(function(){return b.prop("required")},function(a){d.$validate()}))}}}),a.directive("mvAddress",["$mvConfiguration","$q","$http","mvCountryLoader",function(a,b,c,d){function e(a,b){var c=null;if(void 0!==a){var d=a.trim().toLowerCase();angular.forEach(b,function(a){d!=a.Abbreviation.toLowerCase()&&d!=a.Name.toLowerCase()||(c=a)})}return c}return{restrict:"E",templateUrl:function(b,c){return void 0!==c.templateUrl?c.templateUrl:a.templateBasePath+"address-elements.html"},scope:{street:"=",street2:"=?",city:"=",state:"=",zip:"=",country:"=",requiredFields:"=",useStreet2:"=?",fieldChanged:"&?",filterCountries:"&?"},link:function(a,b,c){function f(){if(i[a.country])a.state=i[a.country];else if(void 0!==a.countryObject&&a.countryObject.States){var b=e(a.state,a.countryObject.States);b&&(a.state=b.Abbreviation)}else a.state=""}function g(b){if(void 0===a.countryObject||b!=a.countryObject.Code){var c=!1;angular.forEach(a.countries,function(d){d.Code==b&&(a.countryObject=d,c=!0)}),c||window.console.log("Change the country object; country "+b+" NOT FOUND!")}}function h(){d.then(function(b){if(c.filterCountries){var d=[];angular.forEach(b,function(b){a.filterCountries({country:b})&&d.push(b)}),a.countries=d}else a.countries=b;var e=!1,f=!1;angular.forEach(a.countries,function(b){"US"==b.Code&&(f=!0),a.country==b.Code&&(e=!0)}),e?g(a.country):c.defaultCountryCode?a.country=c.defaultCountryCode:a.country=f?"US":a.countries[0].Code})}var i={};a.countries=[],a.disabled=!1,void 0!==c.ngDisabled&&a.$parent.$watch(c.ngDisabled,function(b){a.disabled=b}),a.street||(a.street=""),a.useStreet2&&!a.street2&&(a.street2=""),a.city||(a.city=""),a.state||(a.state=""),a.zip||(a.zip=""),a.state&&a.country&&(i[a.country]=a.state),a.sendChange=function(b,d,e){a.fieldChanged&&a.fieldChanged({field:c[b],newValue:d,oldValue:e})},a.$watch("country",function(a){void 0!==a&&g(a)}),a.$watch("countryObject.Code",function(b){void 0!==b&&b!=a.country&&(a.country=b,f())}),a.$watch("state",function(b,c){b!==c&&(i[a.country]=b)}),a.stateRequired=function(){var b=!1;return void 0!==a.countryObject&&(b=!!(a.countryObject.States&&a.countryObject.States.length>0)&&(a.requiredFields&&a.requiredFields.state)),b},h(),a.$on("mv-reload-countries",function(){h()})}}}])}(),function(){angular.module("mv.widgets.datepicker",[]).directive("mvSelectDatepicker",["$mvConfiguration",function(a){function b(a,b){var c;c=void 0===a||void 0===b?31:new Date(b,a+1,0).getDate();for(var d=[],e=1;e<=c;e++)d.push({id:e,label:e});return d}function c(a){var b,c=new Date,d=[];if(a.firstYear){for(b=parseInt(a.firstYear);b<=c.getFullYear();b++)d.push({id:b,label:b});d.reverse()}else for(b=c.getFullYear();b<=c.getFullYear()+10;b++)d.push({id:b,label:b});return d}var d=[{id:0,label:"January"},{id:1,label:"February"},{id:2,label:"March"},{id:3,label:"April"},{id:4,label:"May"},{id:5,label:"June"},{id:6,label:"July"},{id:7,label:"August"},{id:8,label:"September"},{id:9,label:"October"},{id:10,label:"November"},{id:11,label:"December"}];return{restrict:"E",require:"ngModel",scope:{firstYear:"@"},templateUrl:function(b,c){return void 0!==c.templateUrl?c.templateUrl:a.templateBasePath+"select-date-picker.html"},link:function(a,e,f,g){a.disabled=!1,void 0!==f.ngDisabled&&a.$parent.$watch(f.ngDisabled,function(b){a.disabled=b}),a.current={day:void 0,month:void 0,year:void 0,days:b(),months:d,years:c(f)},g.$render=function(){var c;void 0!==g.$viewValue&&(c=new Date(g.$viewValue)),a.current.day=c?c.getUTCDate():void 0,a.current.month=c?c.getUTCMonth():void 0,a.current.year=c?c.getUTCFullYear():void 0,a.current.days=b(a.current.month,a.current.year)},a.fieldChanged=function(c){a.current.days=b(a.current.month,a.current.year),void 0!==a.current.day&&void 0!==a.current.month&&void 0!==a.current.year?g.$setViewValue(new Date(a.current.year,a.current.month,a.current.day)):g.$setViewValue(void 0)}}}}])}(),function(){var a=angular.module("mv.upload.button",[]);a.directive("mvInlineUploadButton",["$q","$http","$parse",function(a,b,c){return{restrict:"A",scope:!0,link:function(d,e,f){function g(){var a=e.find("input[type=file]");a.wrap("<form>").closest("form").get(0).reset(),a.unwrap()}function h(a){p&&p.assign(d,a)}function i(){return a(function(a,c){b.post(f.endpointUrl,{verb:"upload-complete",id:f.identifier,bucket:l.uploadBucket,key:l.uploadKey,type:f.type,mimeType:l.mimeType}).then(function(b){b.data.success?a(b.data):(alert(b.data.message),c())},c)})}function j(a,c){b.post(f.endpointUrl,{verb:"upload-parameters",filename:a,id:f.identifier,type:f.type,mimeType:c}).then(function(a){a.data.success?(l={postURL:a.data.result.url,uploadBucket:a.data.result.bucket,uploadParameters:a.data.result.params,uploadKey:a.data.result.params.key,mimeType:a.data.result.mimeType},h(!0),k().then(function(a){i().then(function(a){n&&n(d,a.result),h(!1),g()},function(a){h(!1),g()})},function(a){switch(a.reason){case"loadFailed":case"error":alert("There was an error attempting to upload the file."+a.evt.response);break;case"aborted":alert("The upload has been canceled by the user or the browser dropped the connection.")}h(!1),g()})):(alert(a.data.message),g())})}function k(){return a(function(a,b){var c=new FormData;for(var f in l.uploadParameters)c.append(f,l.uploadParameters[f]);c.append("success_action_status",201);var g=e.find("input[type=file]").get(0).files[0];c.append("file",g);var h=new XMLHttpRequest;h.upload.addEventListener("progress",function(a){if(a.lengthComputable){var b=Math.round(100*a.loaded/a.total);o&&b!=o(d)&&d.$apply(function(){o.assign(d,b)})}},!1),h.addEventListener("load",function(c){c&&201==c.currentTarget.status?d.$apply(function(){a()}):d.$apply(function(){b({reason:"loadFailed",evt:c.currentTarget})})},!1),h.addEventListener("error",function(a){d.$apply(function(){b({reason:"error",evt:a})})},!1),h.addEventListener("abort",function(a){d.$apply(function(){b({reason:"aborted"})})},!1),o&&o.assign(d,0),h.open("POST",l.postURL,!0),h.send(c)})}e.addClass("upload_button"),e.append('<input type="file" accept="'+f.accept+'">');var l=null,m=null,n=null,o=null,p=null;f.previewImageSrc&&(m=c(f.previewImageSrc)),f.onCompletion&&(n=c(f.onCompletion)),f.uploadProgress&&(o=c(f.uploadProgress)),f.uploading&&(p=c(f.uploading)),e.find("input[type=file]").on("change",function(){if($(this).val()){var a=this.files?this.files:[];if(a.length){var b=$(this).val();f.identifier;if(b){var c=a[0].name,e=a[0].type,h=f.accept.split("/"),i=e.split("/"),k=!0;if(h.length==i.length)for(var l=0;l<h.length;l++)h[l]!=i[l]&&"*"!=h[l]&&(k=!1);if(k)if(window.FileReader)if(/^image/.test(e)){var n=f.minImageWidth||0,o=f.minImageHeight||0,p=new FileReader;p.onloadend=function(){var a=this.result;if(n||o){var b=new Image;b.onload=function(){if(n&&this.width<n||o&&this.height<o){var a=[];a.push("This image is too small."),n&&a.push("It must be at least "+n+" pixels wide (It is currently "+this.width+")"),o&&a.push("It must be at least "+o+" pixels tall (It is currently "+this.height+")"),alert(a.join("\n")),g()}else d.$apply(function(){j(c,e)})},b.src=a}d.$apply(function(){m.assign(d,a),n||o||j(c,e)})},p.readAsDataURL(a[0])}else f.defaultPreviewImage?(m.assign(d,f.defaultPreviewImage),j(c,e)):j(c,e);else j(c,e);else{var q="Invalid file type!";if(h.length)switch(h[0]){case"video":q="The selected file is not a valid video file.";break;case"image":q="The selected file is not a valid image file.";break;case"audio":q="The selected file is not a valid audio file."}alert(q),g()}}}}})}}}]),a.directive("mvUploadButtonWithProgress",["$q","$http",function(a,b){return{restrict:"E",scope:{title:"@",accept:"@",type:"@",identifier:"@",endpointUrl:"@",previewImageSrc:"=?",onCompletion:"&?",minImageWidth:"@?",minImageHeight:"@?",uploading:"=?"},template:'<div><progressbar ng-show="state.uploading" style="width: 100%;" value="state.progress"></progressbar><span ng-show="!state.uploading" class="btn btn-file btn-default btn-sm" mv-inline-upload-button type="{{ type }}" accept="{{ accept }}" identifier="{{ identifier }}" endpoint-url="{{ endpointUrl }}" preview-image-src="state.previewImageSrc" on-completion="complete(bucket, key, url)" upload-progress="state.progress" uploading="state.uploading" min-image-width="{{ minImageWidth }}" min-image-height="{{ minImageHeight }}" >{{ title }}</span></div>',link:function(a,b,c){a.state={uploading:!1,progress:0,previewImageSrc:null},a.$watch("state.previewImageSrc",function(b){a.previewImageSrc&&(a.previewImageSrc=b)}),c.uploading&&a.$watch("state.uploading",function(b){a.uploading=b}),a.complete=function(b,c,d){a.onCompletion&&a.onCompletion({bucket:b,key:c,url:d})}}}}])}(),function(){var a=angular.module("mv.utils",["mv.filters","mv.configuration","ui.bootstrap"]);a.directive("flagCheckbox",["$timeout",function(a){return{restrict:"A",scope:{flags:"=",flag:"@flagCheckbox"},link:function(b,c,d){var e=parseInt(b.flag);b.$watch("flags",function(a){void 0!==a&&(c[0].checked=!!(a&e))}),c.on("click",function(){a(function(){c[0].checked?b.flags|=e:b.flags&=~e},1)})}}}]),a.directive("compareTo",function(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(a,b,c,d){d.$validators.compareTo=function(b){return b==a.otherModelValue},a.$watch("otherModelValue",function(){d.$validate()})}}}),a.service("Dialogs",["$uibModal","$sce","$mvConfiguration",function(a,b,c){this.Confirm=function(d,e,f){return a.open({controller:["$scope","$uibModalInstance","message","title","buttons",function(a,c,d,e,f){a.message=b.trustAsHtml(d),a.title=e,a.buttons=f,a.clickButton=function(a){"cancel"==a.type?c.dismiss(a.name):c.close(a)}}],templateUrl:c.templateBasePath+"dialogs/confirm-modal.html",resolve:{message:function(){return d},buttons:function(){return void 0===f?[{name:"OK",type:"ok"},{name:"Cancel",type:"cancel"}]:f},title:function(){return void 0===e?"Confirm":e}}}).result},this.SingleTextAreaEntry=function(d,e,f){return a.open({controller:["$scope","$uibModalInstance","$mvConfiguration","message","title","buttons",function(a,c,d,e,f,g){a.message=b.trustAsHtml(e),a.title=f,a.buttons=g,a.params={textAreaEntry:""},a.clickButton=function(b){"cancel"==b.type?c.dismiss(b.name):c.close({button:b,textAreaEntry:a.params.textAreaEntry})}}],templateUrl:c.templateBasePath+"dialogs/single-text-area-modal.html",resolve:{message:function(){return d},buttons:function(){return void 0===f?[{name:"OK",type:"ok"},{name:"Cancel",type:"cancel"}]:f},title:function(){return void 0===e?"Confirm":e}}}).result}}]),a.service("UtilService",function(){this.CalculateTimeDeltas=function(a,b){var c=new Date,d=null,e=null;b&&(b instanceof Date?d=b:"0000-00-00"!=b&&(d=Date.parse(b))),e=a?a instanceof Date?a:Date.parse(a):c;var f={days:0,hours:0,minutes:0,seconds:0,timeUnits:"",timeValue:""};if(null!=d){var g=c>e?c:e;if(g<d){var h=Math.abs(d-g)/1e3,i=Math.floor(h/86400);h-=86400*i;var j=Math.floor(h/3600)%24;h-=3600*j;var k=Math.floor(h/60)%60;h-=60*k;var l=h%60;f.days=i,f.hours=j,f.minutes=k,f.seconds=l,i>0?(f.timeValue=i,f.timeUnits=1==i?"day left":"days left"):j>0?(f.timeValue=j,f.timeUnits=1==j?"hour left":"hours left"):k>0?(f.timeValue=k,f.timeUnits=1==k?"minute left":"minutes left"):l>0&&(f.timeValue=l,f.timeUnits=1==l?"second left":"seconds left")}else f.timeValue=""}else f.timeValue="Unknown",f.timeUnits="days left";return f}}),a.directive("onlyDigits",function(){return{restrict:"EA",require:"?ngModel",link:function(a,b,c,d){d&&(c.minDecimalDigits&&b.blur(function(){if(d.$viewValue){var a=d.$viewValue,b=0,e=a.indexOf(".");-1===e?(a+=".",b=c.minDecimalDigits):b=c.minDecimalDigits-(a.length-1-e);for(var f=0;f<b;f++)a+="0";a!==d.$viewValue&&(d.$setViewValue(a),d.$render())}}),d.$parsers.unshift(function(a){var b=!1,e=0,f=c.allowDecimal&&"true"==c.allowDecimal;(c.maxDecimalDigits||c.minDecimalDigits)&&(f=!0);var g=a.split("").filter(function(a,d){var g=!isNaN(a)&&" "!=a;return g&&e++,!g&&f&&"."==a&&!1===b&&(b=!0,e=0,g=!0),!g&&c.allowNegative&&"true"==c.allowNegative&&(g="-"==a&&0===parseInt(d)),g&&b&&c.maxDecimalDigits&&e>c.maxDecimalDigits&&(g=!1),g}).join("");return c.maxNum&&!isNaN(c.maxNum)&&parseFloat(g)>parseFloat(c.maxNum)&&(g=c.maxNum),c.minNum&&!isNaN(c.minNum)&&parseFloat(g)<parseFloat(c.minNum)&&(g=c.minNum),d.$setViewValue(g),d.$render(),g}))}}}),a.directive("onlyNumber",function(){return{require:"ngModel",restrict:"AC",link:function(a,b,c,d){function e(a){if(a){var b=a.replace(/[^0-9]/g,"");return b!==a&&(d.$setViewValue(b),d.$render()),parseInt(b,10)}}d.$parsers.push(e)}}}),a.directive("thousandsComma",["$filter",function(a){return{require:"?ngModel",link:function(b,c,d,e){function f(b){var d,e;return""!==b?(e=b.replace(/[\,\.]/g,""),d=a("number")(e),c.val(d)):(d="",e=""),c.val(d),e}function g(a){if(a){var b=a.replace(/[^0-9\,]/g,"");return b!==a&&(e.$setViewValue(b),e.$render()),b}}e&&(e.$formatters.unshift(function(){return""!==e.$modelValue?a("number")(e.$modelValue):""}),e.$parsers.unshift(f),e.$parsers.unshift(g))}}}]),a.directive("mvEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.mvEnter)}),b.preventDefault())})}}),/**
		 * angular-elastic-input
		 * A directive for AngularJS which automatically resizes the width of input field according to the content, while typing.
		 * @author: Jacek Pulit <jacek.pulit@gmail.com>
		 * @license: MIT License
		 */
a.directive("mvElasticInput",function(){return{require:"?ngModel",restrict:"A",link:function(a,b,c,d){function e(){c.placeholder?g.text(b.val()||c.placeholder):g.text(b.val()),b.css("width",g.outerWidth()+1)}var f=angular.element('<div style="position:fixed; top:-999px; left:0;"></div>'),g=angular.element('<span style="white-space:pre;"></span>'),h="none"===b.css("maxWidth")?b.parent().innerWidth():b.css("maxWidth");b.css("minWidth",c.mvElasticInputMinwidth||b.css("minWidth")),b.css("maxWidth",c.mvElasticInputMaxwidth||h),angular.forEach(["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent","boxSizing","borderRightWidth","borderLeftWidth","borderLeftStyle","borderRightStyle","paddingLeft","paddingRight","marginLeft","marginRight"],function(a){g.css(a,b.css(a))}),angular.element("body").append(f.append(g)),e(),d?a.$watch(c.ngModel,function(){e()}):b.on("keydown keyup focus input propertychange change",function(){e()})}}})}(),function(){var a=angular.module("mv.widgets",["mv.widgets.datepicker"]);a.directive("showValidationIcon",function(){return{restrict:"A",require:"?ngModel",link:function(a,b,c,d){function e(a,b){a?b?(void 0!==f&&f.removeClass("has-error").addClass("has-success"),void 0!==i&&i.removeClass("hidden").removeClass("glyphicon-remove").addClass("glyphicon-ok")):(void 0!==f&&f.removeClass("has-success").addClass("has-error"),void 0!==i&&i.removeClass("hidden").removeClass("glyphicon-ok").addClass("glyphicon-remove")):(void 0!==f&&f.removeClass("has-success").removeClass("has-error"),void 0!==i&&i.addClass("hidden"))}if(d){for(var f,g=void 0===c.delayValidation,h=b.parent();h.length>0;){if(h.hasClass("form-group")){h.addClass("has-feedback"),f=h;break}h=h.parent()}var i;"INPUT"!=b.prop("tagName")||void 0!==f&&f.hasClass("input-group")||(i=angular.element('<span class="form-control-feedback glyphicon glyphicon-ok hidden"></span>'),b.after(i)),a.$watch(function(){return d.$dirty+"-"+d.$valid+"-"+d.$touched},function(){e(g&&d.$dirty||d.$touched,d.$valid)})}}}}),a.directive("flashAlert",["$timeout",function(a){return{restrict:"E",scope:{type:"=",message:"=",duration:"=?"},template:'<div ng-show="message" class="alert" ng-class="alertClass"><button type="button" class="close" ng-click="visible= false">x</button><strong>{{ strongText }}</strong> <span ng-bind-html="message"></span></div>',link:function(b,c,d){b.$watch("type",function(){if(b.type)switch(b.type){case"info":b.alertClass="alert-info",b.strongText="";break;case"warning":b.alertClass="alert-warning",b.strongText="Warning:";break;case"error":b.alertClass="alert-danger",b.strongText="Error:";break;case"success":b.alertClass="alert-success",b.strongText=""}}),b.$watch("message",function(c){if(c){var d=b.duration||5e3;a(function(){b.message=void 0},d)}})}}}]),a.directive("itemExpander",function(){return{restrict:"E",transclude:!0,scope:{title:"@",expanded:"=?"},template:'<h4><a href="#" ng-click="toggle($event)"><span class="glyphicon" ng-class="iconClass"></span>{{ title }}</a></h4><div ng-show="expanded"><ng-transclude></ng-transclude></div>',link:function(a,b,c){a.toggle=function(b){b.preventDefault(),a.expanded=!a.expanded},a.$watch("expanded",function(b){a.iconClass=b?"glyphicon-collapse-down":"glyphicon-collapse-up"})}}}),a.directive("audioPlayer",function(){return{restrict:"E",link:function(a,b,c){c.audioUrl?(b.append('<div id="'+c.containerId+'">Loading the player...</div>'),jwplayer(c.containerId).setup({file:c.audioUrl,supplied:"mp3",width:"100%",height:30})):b.append('<p class="text-center h4">This audio is still processing on the server.<br/>Please refresh this page in a few minutes.</p>')}}}),a.directive("videoPlayer",function(){return{restrict:"E",link:function(a,b,c){c.videoUrl?(b.append('<div id="'+c.containerId+'">Loading the player...</div>'),jwplayer(c.containerId).setup({file:c.videoUrl,image:c.imageUrl,width:"100%",aspectratio:c.width+":"+c.height,stretching:"exactfit"})):b.append('<p class="text-center h4">This video is still processing on the server.<br/>Please refresh this page in a few minutes to view.</p>')}}})}();